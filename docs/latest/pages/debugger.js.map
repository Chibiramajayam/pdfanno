{"version":3,"sources":["pages/debugger.js"],"names":["FontInspector","fonts","active","fontAttribute","resetSelection","divs","document","querySelectorAll","i","ii","length","className","selectFont","fontName","show","textLayerClick","e","target","dataset","tagName","toUpperCase","selects","getElementsByTagName","select","checked","scrollIntoView","id","name","panel","manager","init","this","setAttribute","tmp","createElement","addEventListener","textContent","appendChild","cleanup","enabled","value","body","removeEventListener","removeSelection","fontAdded","fontObj","url","moreInfo","obj","list","tr","td1","td2","toString","properties","loadedName","font","download","exec","href","data","URL","createObjectURL","Blob","type","mimeType","logIt","event","preventDefault","console","log","createTextNode","setTimeout","bind","StepperManager","steppers","stepperDiv","stepperControls","stepperChooser","breakPoints","self","selectStepper","sessionStorage","getItem","JSON","parse","create","pageIndex","debug","b","initBreakPoints","stepper","Stepper","push","selectPanel","removeAttribute","options","option","selected","saveBreakPoints","bps","setItem","stringify","c","tag","d","opMap","simplifyArgs","args","substr","simpleArgs","Math","min","simpleObj","key","initialBreakPoints","breakPoint","nextBreakPoint","currentIdx","operatorListIdx","prototype","content","table","cellSpacing","headerRow","Object","PDFJS","OPS","updateOperatorList","operatorList","cboxOnClick","x","idx","splice","indexOf","chunk","createDocumentFragment","operatorsToDisplay","fnArray","line","argsArray","breakCell","cbox","onclick","fn","decArgs","glyphs","newArgs","str","j","glyph","fontChar","join","lastCell","colspan","getNextBreakPoint","sort","a","breakIt","callback","dom","listener","keyCode","goTo","allRows","getElementsByClassName","xx","row","style","backgroundColor","Stats","stats","clear","node","hasChildNodes","removeChild","lastChild","enableStats","add","pageNumber","stat","statsIndex","getStatIndex","div","wrapper","title","statsDiv","PDFBug","buttons","activePanel","tools","enable","ids","all","tool","indexA","indexB","ui","controls","panels","container","getElementById","right","panelWidth","panelButton","index"],"mappings":"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","file":"debugger.js","sourcesContent":["/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/* globals PDFJS */\n\n'use strict';\n\nvar FontInspector = (function FontInspectorClosure() {\n  var fonts;\n  var active = false;\n  var fontAttribute = 'data-font-name';\n  function removeSelection() {\n    var divs = document.querySelectorAll('div[' + fontAttribute + ']');\n    for (var i = 0, ii = divs.length; i < ii; ++i) {\n      var div = divs[i];\n      div.className = '';\n    }\n  }\n  function resetSelection() {\n    var divs = document.querySelectorAll('div[' + fontAttribute + ']');\n    for (var i = 0, ii = divs.length; i < ii; ++i) {\n      var div = divs[i];\n      div.className = 'debuggerHideText';\n    }\n  }\n  function selectFont(fontName, show) {\n    var divs = document.querySelectorAll('div[' + fontAttribute + '=' +\n                                         fontName + ']');\n    for (var i = 0, ii = divs.length; i < ii; ++i) {\n      var div = divs[i];\n      div.className = show ? 'debuggerShowText' : 'debuggerHideText';\n    }\n  }\n  function textLayerClick(e) {\n    if (!e.target.dataset.fontName ||\n        e.target.tagName.toUpperCase() !== 'DIV') {\n      return;\n    }\n    var fontName = e.target.dataset.fontName;\n    var selects = document.getElementsByTagName('input');\n    for (var i = 0; i < selects.length; ++i) {\n      var select = selects[i];\n      if (select.dataset.fontName !== fontName) {\n        continue;\n      }\n      select.checked = !select.checked;\n      selectFont(fontName, select.checked);\n      select.scrollIntoView();\n    }\n  }\n  return {\n    // Properties/functions needed by PDFBug.\n    id: 'FontInspector',\n    name: 'Font Inspector',\n    panel: null,\n    manager: null,\n    init: function init() {\n      var panel = this.panel;\n      panel.setAttribute('style', 'padding: 5px;');\n      var tmp = document.createElement('button');\n      tmp.addEventListener('click', resetSelection);\n      tmp.textContent = 'Refresh';\n      panel.appendChild(tmp);\n\n      fonts = document.createElement('div');\n      panel.appendChild(fonts);\n    },\n    cleanup: function cleanup() {\n      fonts.textContent = '';\n    },\n    enabled: false,\n    get active() {\n      return active;\n    },\n    set active(value) {\n      active = value;\n      if (active) {\n        document.body.addEventListener('click', textLayerClick, true);\n        resetSelection();\n      } else {\n        document.body.removeEventListener('click', textLayerClick, true);\n        removeSelection();\n      }\n    },\n    // FontInspector specific functions.\n    fontAdded: function fontAdded(fontObj, url) {\n      function properties(obj, list) {\n        var moreInfo = document.createElement('table');\n        for (var i = 0; i < list.length; i++) {\n          var tr = document.createElement('tr');\n          var td1 = document.createElement('td');\n          td1.textContent = list[i];\n          tr.appendChild(td1);\n          var td2 = document.createElement('td');\n          td2.textContent = obj[list[i]].toString();\n          tr.appendChild(td2);\n          moreInfo.appendChild(tr);\n        }\n        return moreInfo;\n      }\n      var moreInfo = properties(fontObj, ['name', 'type']);\n      var fontName = fontObj.loadedName;\n      var font = document.createElement('div');\n      var name = document.createElement('span');\n      name.textContent = fontName;\n      var download = document.createElement('a');\n      if (url) {\n        url = /url\\(['\"]?([^\\)\"']+)/.exec(url);\n        download.href = url[1];\n      } else if (fontObj.data) {\n        url = URL.createObjectURL(new Blob([fontObj.data], {\n          type: fontObj.mimeType\n        }));\n        download.href = url;\n      }\n      download.textContent = 'Download';\n      var logIt = document.createElement('a');\n      logIt.href = '';\n      logIt.textContent = 'Log';\n      logIt.addEventListener('click', function(event) {\n        event.preventDefault();\n        console.log(fontObj);\n      });\n      var select = document.createElement('input');\n      select.setAttribute('type', 'checkbox');\n      select.dataset.fontName = fontName;\n      select.addEventListener('click', (function(select, fontName) {\n        return (function() {\n           selectFont(fontName, select.checked);\n        });\n      })(select, fontName));\n      font.appendChild(select);\n      font.appendChild(name);\n      font.appendChild(document.createTextNode(' '));\n      font.appendChild(download);\n      font.appendChild(document.createTextNode(' '));\n      font.appendChild(logIt);\n      font.appendChild(moreInfo);\n      fonts.appendChild(font);\n      // Somewhat of a hack, should probably add a hook for when the text layer\n      // is done rendering.\n      setTimeout(function() {\n        if (this.active) {\n          resetSelection();\n        }\n      }.bind(this), 2000);\n    }\n  };\n})();\n\n// Manages all the page steppers.\nvar StepperManager = (function StepperManagerClosure() {\n  var steppers = [];\n  var stepperDiv = null;\n  var stepperControls = null;\n  var stepperChooser = null;\n  var breakPoints = {};\n  return {\n    // Properties/functions needed by PDFBug.\n    id: 'Stepper',\n    name: 'Stepper',\n    panel: null,\n    manager: null,\n    init: function init() {\n      var self = this;\n      this.panel.setAttribute('style', 'padding: 5px;');\n      stepperControls = document.createElement('div');\n      stepperChooser = document.createElement('select');\n      stepperChooser.addEventListener('change', function(event) {\n        self.selectStepper(this.value);\n      });\n      stepperControls.appendChild(stepperChooser);\n      stepperDiv = document.createElement('div');\n      this.panel.appendChild(stepperControls);\n      this.panel.appendChild(stepperDiv);\n      if (sessionStorage.getItem('pdfjsBreakPoints')) {\n        breakPoints = JSON.parse(sessionStorage.getItem('pdfjsBreakPoints'));\n      }\n    },\n    cleanup: function cleanup() {\n      stepperChooser.textContent = '';\n      stepperDiv.textContent = '';\n      steppers = [];\n    },\n    enabled: false,\n    active: false,\n    // Stepper specific functions.\n    create: function create(pageIndex) {\n      var debug = document.createElement('div');\n      debug.id = 'stepper' + pageIndex;\n      debug.setAttribute('hidden', true);\n      debug.className = 'stepper';\n      stepperDiv.appendChild(debug);\n      var b = document.createElement('option');\n      b.textContent = 'Page ' + (pageIndex + 1);\n      b.value = pageIndex;\n      stepperChooser.appendChild(b);\n      var initBreakPoints = breakPoints[pageIndex] || [];\n      var stepper = new Stepper(debug, pageIndex, initBreakPoints);\n      steppers.push(stepper);\n      if (steppers.length === 1) {\n        this.selectStepper(pageIndex, false);\n      }\n      return stepper;\n    },\n    selectStepper: function selectStepper(pageIndex, selectPanel) {\n      var i;\n      pageIndex = pageIndex | 0;\n      if (selectPanel) {\n        this.manager.selectPanel(this);\n      }\n      for (i = 0; i < steppers.length; ++i) {\n        var stepper = steppers[i];\n        if (stepper.pageIndex === pageIndex) {\n          stepper.panel.removeAttribute('hidden');\n        } else {\n          stepper.panel.setAttribute('hidden', true);\n        }\n      }\n      var options = stepperChooser.options;\n      for (i = 0; i < options.length; ++i) {\n        var option = options[i];\n        option.selected = (option.value | 0) === pageIndex;\n      }\n    },\n    saveBreakPoints: function saveBreakPoints(pageIndex, bps) {\n      breakPoints[pageIndex] = bps;\n      sessionStorage.setItem('pdfjsBreakPoints', JSON.stringify(breakPoints));\n    }\n  };\n})();\n\n// The stepper for each page's IRQueue.\nvar Stepper = (function StepperClosure() {\n  // Shorter way to create element and optionally set textContent.\n  function c(tag, textContent) {\n    var d = document.createElement(tag);\n    if (textContent) {\n      d.textContent = textContent;\n    }\n    return d;\n  }\n\n  var opMap = null;\n\n  function simplifyArgs(args) {\n    if (typeof args === 'string') {\n      var MAX_STRING_LENGTH = 75;\n      return args.length <= MAX_STRING_LENGTH ? args :\n        args.substr(0, MAX_STRING_LENGTH) + '...';\n    }\n    if (typeof args !== 'object' || args === null) {\n      return args;\n    }\n    if ('length' in args) { // array\n      var simpleArgs = [], i, ii;\n      var MAX_ITEMS = 10;\n      for (i = 0, ii = Math.min(MAX_ITEMS, args.length); i < ii; i++) {\n        simpleArgs.push(simplifyArgs(args[i]));\n      }\n      if (i < args.length) {\n        simpleArgs.push('...');\n      }\n      return simpleArgs;\n    }\n    var simpleObj = {};\n    for (var key in args) {\n      simpleObj[key] = simplifyArgs(args[key]);\n    }\n    return simpleObj;\n  }\n\n  function Stepper(panel, pageIndex, initialBreakPoints) {\n    this.panel = panel;\n    this.breakPoint = 0;\n    this.nextBreakPoint = null;\n    this.pageIndex = pageIndex;\n    this.breakPoints = initialBreakPoints;\n    this.currentIdx = -1;\n    this.operatorListIdx = 0;\n  }\n  Stepper.prototype = {\n    init: function init() {\n      var panel = this.panel;\n      var content = c('div', 'c=continue, s=step');\n      var table = c('table');\n      content.appendChild(table);\n      table.cellSpacing = 0;\n      var headerRow = c('tr');\n      table.appendChild(headerRow);\n      headerRow.appendChild(c('th', 'Break'));\n      headerRow.appendChild(c('th', 'Idx'));\n      headerRow.appendChild(c('th', 'fn'));\n      headerRow.appendChild(c('th', 'args'));\n      panel.appendChild(content);\n      this.table = table;\n      if (!opMap) {\n        opMap = Object.create(null);\n        for (var key in PDFJS.OPS) {\n          opMap[PDFJS.OPS[key]] = key;\n        }\n      }\n    },\n    updateOperatorList: function updateOperatorList(operatorList) {\n      var self = this;\n\n      function cboxOnClick() {\n        var x = +this.dataset.idx;\n        if (this.checked) {\n          self.breakPoints.push(x);\n        } else {\n          self.breakPoints.splice(self.breakPoints.indexOf(x), 1);\n        }\n        StepperManager.saveBreakPoints(self.pageIndex, self.breakPoints);\n      }\n\n      var MAX_OPERATORS_COUNT = 15000;\n      if (this.operatorListIdx > MAX_OPERATORS_COUNT) {\n        return;\n      }\n\n      var chunk = document.createDocumentFragment();\n      var operatorsToDisplay = Math.min(MAX_OPERATORS_COUNT,\n                                        operatorList.fnArray.length);\n      for (var i = this.operatorListIdx; i < operatorsToDisplay; i++) {\n        var line = c('tr');\n        line.className = 'line';\n        line.dataset.idx = i;\n        chunk.appendChild(line);\n        var checked = this.breakPoints.indexOf(i) !== -1;\n        var args = operatorList.argsArray[i] || [];\n\n        var breakCell = c('td');\n        var cbox = c('input');\n        cbox.type = 'checkbox';\n        cbox.className = 'points';\n        cbox.checked = checked;\n        cbox.dataset.idx = i;\n        cbox.onclick = cboxOnClick;\n\n        breakCell.appendChild(cbox);\n        line.appendChild(breakCell);\n        line.appendChild(c('td', i.toString()));\n        var fn = opMap[operatorList.fnArray[i]];\n        var decArgs = args;\n        if (fn === 'showText') {\n          var glyphs = args[0];\n          var newArgs = [];\n          var str = [];\n          for (var j = 0; j < glyphs.length; j++) {\n            var glyph = glyphs[j];\n            if (typeof glyph === 'object' && glyph !== null) {\n              str.push(glyph.fontChar);\n            } else {\n              if (str.length > 0) {\n                newArgs.push(str.join(''));\n                str = [];\n              }\n              newArgs.push(glyph); // null or number\n            }\n          }\n          if (str.length > 0) {\n            newArgs.push(str.join(''));\n          }\n          decArgs = [newArgs];\n        }\n        line.appendChild(c('td', fn));\n        line.appendChild(c('td', JSON.stringify(simplifyArgs(decArgs))));\n      }\n      if (operatorsToDisplay < operatorList.fnArray.length) {\n        line = c('tr');\n        var lastCell = c('td', '...');\n        lastCell.colspan = 4;\n        chunk.appendChild(lastCell);\n      }\n      this.operatorListIdx = operatorList.fnArray.length;\n      this.table.appendChild(chunk);\n    },\n    getNextBreakPoint: function getNextBreakPoint() {\n      this.breakPoints.sort(function(a, b) { return a - b; });\n      for (var i = 0; i < this.breakPoints.length; i++) {\n        if (this.breakPoints[i] > this.currentIdx) {\n          return this.breakPoints[i];\n        }\n      }\n      return null;\n    },\n    breakIt: function breakIt(idx, callback) {\n      StepperManager.selectStepper(this.pageIndex, true);\n      var self = this;\n      var dom = document;\n      self.currentIdx = idx;\n      var listener = function(e) {\n        switch (e.keyCode) {\n          case 83: // step\n            dom.removeEventListener('keydown', listener, false);\n            self.nextBreakPoint = self.currentIdx + 1;\n            self.goTo(-1);\n            callback();\n            break;\n          case 67: // continue\n            dom.removeEventListener('keydown', listener, false);\n            var breakPoint = self.getNextBreakPoint();\n            self.nextBreakPoint = breakPoint;\n            self.goTo(-1);\n            callback();\n            break;\n        }\n      };\n      dom.addEventListener('keydown', listener, false);\n      self.goTo(idx);\n    },\n    goTo: function goTo(idx) {\n      var allRows = this.panel.getElementsByClassName('line');\n      for (var x = 0, xx = allRows.length; x < xx; ++x) {\n        var row = allRows[x];\n        if ((row.dataset.idx | 0) === idx) {\n          row.style.backgroundColor = 'rgb(251,250,207)';\n          row.scrollIntoView();\n        } else {\n          row.style.backgroundColor = null;\n        }\n      }\n    }\n  };\n  return Stepper;\n})();\n\nvar Stats = (function Stats() {\n  var stats = [];\n  function clear(node) {\n    while (node.hasChildNodes()) {\n      node.removeChild(node.lastChild);\n    }\n  }\n  function getStatIndex(pageNumber) {\n    for (var i = 0, ii = stats.length; i < ii; ++i) {\n      if (stats[i].pageNumber === pageNumber) {\n        return i;\n      }\n    }\n    return false;\n  }\n  return {\n    // Properties/functions needed by PDFBug.\n    id: 'Stats',\n    name: 'Stats',\n    panel: null,\n    manager: null,\n    init: function init() {\n      this.panel.setAttribute('style', 'padding: 5px;');\n      PDFJS.enableStats = true;\n    },\n    enabled: false,\n    active: false,\n    // Stats specific functions.\n    add: function(pageNumber, stat) {\n      if (!stat) {\n        return;\n      }\n      var statsIndex = getStatIndex(pageNumber);\n      if (statsIndex !== false) {\n        var b = stats[statsIndex];\n        this.panel.removeChild(b.div);\n        stats.splice(statsIndex, 1);\n      }\n      var wrapper = document.createElement('div');\n      wrapper.className = 'stats';\n      var title = document.createElement('div');\n      title.className = 'title';\n      title.textContent = 'Page: ' + pageNumber;\n      var statsDiv = document.createElement('div');\n      statsDiv.textContent = stat.toString();\n      wrapper.appendChild(title);\n      wrapper.appendChild(statsDiv);\n      stats.push({ pageNumber: pageNumber, div: wrapper });\n      stats.sort(function(a, b) { return a.pageNumber - b.pageNumber; });\n      clear(this.panel);\n      for (var i = 0, ii = stats.length; i < ii; ++i) {\n        this.panel.appendChild(stats[i].div);\n      }\n    },\n    cleanup: function () {\n      stats = [];\n      clear(this.panel);\n    }\n  };\n})();\n\n// Manages all the debugging tools.\nvar PDFBug = (function PDFBugClosure() {\n  var panelWidth = 300;\n  var buttons = [];\n  var activePanel = null;\n\n  return {\n    tools: [\n      FontInspector,\n      StepperManager,\n      Stats\n    ],\n    enable: function(ids) {\n      var all = false, tools = this.tools;\n      if (ids.length === 1 && ids[0] === 'all') {\n        all = true;\n      }\n      for (var i = 0; i < tools.length; ++i) {\n        var tool = tools[i];\n        if (all || ids.indexOf(tool.id) !== -1) {\n          tool.enabled = true;\n        }\n      }\n      if (!all) {\n        // Sort the tools by the order they are enabled.\n        tools.sort(function(a, b) {\n          var indexA = ids.indexOf(a.id);\n          indexA = indexA < 0 ? tools.length : indexA;\n          var indexB = ids.indexOf(b.id);\n          indexB = indexB < 0 ? tools.length : indexB;\n          return indexA - indexB;\n        });\n      }\n    },\n    init: function init() {\n      /*\n       * Basic Layout:\n       * PDFBug\n       *  Controls\n       *  Panels\n       *    Panel\n       *    Panel\n       *    ...\n       */\n      var ui = document.createElement('div');\n      ui.id = 'PDFBug';\n\n      var controls = document.createElement('div');\n      controls.setAttribute('class', 'controls');\n      ui.appendChild(controls);\n\n      var panels = document.createElement('div');\n      panels.setAttribute('class', 'panels');\n      ui.appendChild(panels);\n\n      var container = document.getElementById('viewerContainer');\n      container.appendChild(ui);\n      container.style.right = panelWidth + 'px';\n\n      // Initialize all the debugging tools.\n      var tools = this.tools;\n      var self = this;\n      for (var i = 0; i < tools.length; ++i) {\n        var tool = tools[i];\n        var panel = document.createElement('div');\n        var panelButton = document.createElement('button');\n        panelButton.textContent = tool.name;\n        panelButton.addEventListener('click', (function(selected) {\n          return function(event) {\n            event.preventDefault();\n            self.selectPanel(selected);\n          };\n        })(i));\n        controls.appendChild(panelButton);\n        panels.appendChild(panel);\n        tool.panel = panel;\n        tool.manager = this;\n        if (tool.enabled) {\n          tool.init();\n        } else {\n          panel.textContent = tool.name + ' is disabled. To enable add ' +\n                              ' \"' + tool.id + '\" to the pdfBug parameter ' +\n                              'and refresh (seperate multiple by commas).';\n        }\n        buttons.push(panelButton);\n      }\n      this.selectPanel(0);\n    },\n    cleanup: function cleanup() {\n      for (var i = 0, ii = this.tools.length; i < ii; i++) {\n        if (this.tools[i].enabled) {\n          this.tools[i].cleanup();\n        }\n      }\n    },\n    selectPanel: function selectPanel(index) {\n      if (typeof index !== 'number') {\n        index = this.tools.indexOf(index);\n      }\n      if (index === activePanel) {\n        return;\n      }\n      activePanel = index;\n      var tools = this.tools;\n      for (var j = 0; j < tools.length; ++j) {\n        if (j === index) {\n          buttons[j].setAttribute('class', 'active');\n          tools[j].active = true;\n          tools[j].panel.removeAttribute('hidden');\n        } else {\n          buttons[j].setAttribute('class', '');\n          tools[j].active = false;\n          tools[j].panel.setAttribute('hidden', 'true');\n        }\n      }\n    }\n  };\n})();\n"]}