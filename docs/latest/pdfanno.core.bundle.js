(function(e,t){'object'==typeof exports&&'object'==typeof module?module.exports=t():'function'==typeof define&&define.amd?define([],t):'object'==typeof exports?exports.PDFAnnoCore=t():e.PDFAnnoCore=t()})(this,function(){var e=Math.min,t=Math.abs,n=Math.sin,o=Math.cos,i=Math.atan,r=Math.floor;return function(e){function t(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e['default']}:function(){return e};return t.d(n,'a',n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p='',t(t.s=69)}([,function(e,t){'use strict';function n(){let e=window.PDFView||window.iframeWindow.PDFView,t=e.pdfViewer.getPageView(0).viewport.viewBox,n={width:t[2],height:t[3]};return n}t.b=function(e){let t=n();e-=o;let a=t.height+i,l=r(e/a)+1,s=e-(l-1)*a;return{pageNumber:l,y:s}},t.a=function(e,t){let r=n(),a=t+o;return a+=(e-1)*(r.height+i),a},t.c=function(){let e=window.iframeWindow?window.iframeWindow:window;return e.nextZIndex||(e.nextZIndex=10),e.nextZIndex++};const o=9,i=9;t.d=i},function(e,t){'use strict';t.a=function(e,t){return 0<t.filter((t)=>t===e).length},t.b=function(e,t){var n=document.createEvent('CustomEvent');n.initCustomEvent(e,!0,!0,t),window.dispatchEvent(n)},t.c=function(){return window.location.search.replace('?','').split('&').reduce((e,t)=>{const[n,o]=t.split('=');return e[n]=o,e},{})}},,function(e,t){'use strict';t.a=function(e=8){const t='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789',n=t.length;let o='';for(let a=0;a<e;a++)o+=t[r(Math.random()*n)];return o}},function(e){e.exports=function(){var e=[];return e.toString=function(){for(var e,t=[],n=0;n<this.length;n++)e=this[n],e[2]?t.push('@media '+e[2]+'{'+e[1]+'}'):t.push(e[1]);return t.join('')},e.i=function(t,n){'string'==typeof t&&(t=[[null,t,'']]);for(var o,r={},a=0;a<this.length;a++)o=this[a][0],'number'==typeof o&&(r[o]=!0);for(a=0;a<t.length;a++){var i=t[a];'number'==typeof i[0]&&r[i[0]]||(n&&!i[2]?i[2]=n:n&&(i[2]='('+i[2]+') and ('+n+')'),e.push(i))}},e}},function(e){function t(e,t){for(var n=0;n<e.length;n++){var o=e[n],i=p[o.id];if(i){i.refs++;for(var r=0;r<i.parts.length;r++)i.parts[r](o.parts[r]);for(;r<o.parts.length;r++)i.parts.push(l(o.parts[r],t))}else{for(var a=[],r=0;r<o.parts.length;r++)a.push(l(o.parts[r],t));p[o.id]={id:o.id,refs:1,parts:a}}}}function n(e){for(var t=[],n={},o=0;o<e.length;o++){var i=e[o],r=i[0],a=i[1],l=i[2],s=i[3],d={css:a,media:l,sourceMap:s};n[r]?n[r].parts.push(d):t.push(n[r]={id:r,parts:[d]})}return t}function o(e,t){var n=y(),o=x[x.length-1];if('top'===e.insertAt)o?o.nextSibling?n.insertBefore(t,o.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),x.push(t);else if('bottom'===e.insertAt)n.appendChild(t);else throw new Error('Invalid value for parameter \'insertAt\'. Must be \'top\' or \'bottom\'.')}function i(e){e.parentNode.removeChild(e);var t=x.indexOf(e);0<=t&&x.splice(t,1)}function r(e){var t=document.createElement('style');return t.type='text/css',o(e,t),t}function a(e){var t=document.createElement('link');return t.rel='stylesheet',o(e,t),t}function l(e,t){var n,o,l;if(t.singleton){var p=g++;n=v||(v=r(t)),o=s.bind(null,n,p,!1),l=s.bind(null,n,p,!0)}else e.sourceMap&&'function'==typeof URL&&'function'==typeof URL.createObjectURL&&'function'==typeof URL.revokeObjectURL&&'function'==typeof Blob&&'function'==typeof btoa?(n=a(t),o=u.bind(null,n),l=function(){i(n),n.href&&URL.revokeObjectURL(n.href)}):(n=r(t),o=d.bind(null,n),l=function(){i(n)});return o(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;o(e=t)}else l()}}function s(e,t,n,o){var i=n?'':o.css;if(e.styleSheet)e.styleSheet.cssText=f(t,i);else{var r=document.createTextNode(i),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(r,a[t]):e.appendChild(r)}}function d(e,t){var n=t.css,o=t.media;if(o&&e.setAttribute('media',o),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function u(e,t){var n=t.css,o=t.sourceMap;o&&(n+='\n/*# sourceMappingURL=data:application/json;base64,'+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+' */');var i=new Blob([n],{type:'text/css'}),r=e.href;e.href=URL.createObjectURL(i),r&&URL.revokeObjectURL(r)}var p={},c=function(e){var t;return function(){return'undefined'==typeof t&&(t=e.apply(this,arguments)),t}},h=c(function(){return /msie [6-9]\b/.test(self.navigator.userAgent.toLowerCase())}),y=c(function(){return document.head||document.getElementsByTagName('head')[0]}),v=null,g=0,x=[];e.exports=function(e,o){if('undefined'!=typeof DEBUG&&DEBUG&&'object'!=typeof document)throw new Error('The style-loader cannot be used in a non-browser environment');o=o||{},'undefined'==typeof o.singleton&&(o.singleton=h()),'undefined'==typeof o.insertAt&&(o.insertAt='bottom');var r=n(e);return t(r,o),function(e){for(var a=[],l=0;l<r.length;l++){var i=r[l],s=p[i.id];s.refs--,a.push(s)}if(e){var d=n(e);t(d,o)}for(var s,l=0;l<a.length;l++)if(s=a[l],0===s.refs){for(var u=0;u<s.parts.length;u++)s.parts[u]();delete p[s.id]}}};var f=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join('\n')}}()},,,,,,function(e,t,n){var o=n(13),i=n(14);e.exports={parse:function(e){var t=o.parse(e.toString());return i.compile(t)}}},function(e){e.exports=function(){function e(e,t,n,o,i,r){this.message=e,this.expected=t,this.found=n,this.offset=o,this.line=i,this.column=r,this.name='SyntaxError'}function t(t){function n(){return i(Rn).line}function o(){return i(Rn).column}function i(e){return On!==e&&(On>e&&(On=0,Vn={line:1,column:1,seenCR:!1}),function(e,n,o){var i,r;for(i=n;i<o;i++)r=t.charAt(i),'\n'===r?(!e.seenCR&&e.line++,e.column=1,e.seenCR=!1):'\r'===r||'\u2028'===r||'\u2029'===r?(e.line++,e.column=1,e.seenCR=!0):(e.column++,e.seenCR=!1)}(Vn,On,e),On=e),Vn}function a(e){Ln<Tn||(Ln>Tn&&(Tn=Ln,In=[]),In.push(e))}function l(){var e,t,n,o=49*Ln+0,i=Sn[o];if(i)return Ln=i.nextPos,i.result;for(e=Ln,t=[],n=s();n!==pe;)t.push(n),n=s();return t!==pe&&(Rn=e,t=ye()),e=t,Sn[o]={nextPos:Ln,result:e},e}function s(){var e,t,n,o,i,r,a,l=49*Ln+1,s=Sn[l];if(s)return Ln=s.nextPos,s.result;for(e=Ln,t=[],n=Z();n!==pe;)t.push(n),n=Z();if(t===pe)Ln=e,e=ve;else if(n=d(),n!==pe){for(o=[],i=Z();i!==pe;)o.push(i),i=Z();if(o!==pe){for(i=[],r=u();r!==pe;)i.push(r),r=u();if(i!==pe){if(r=[],a=W(),a!==pe)for(;a!==pe;)r.push(a),a=W();else r=ve;r===pe&&(r=G()),r===pe?(Ln=e,e=ve):(t=[t,n,o,i,r],e=t)}else Ln=e,e=ve}else Ln=e,e=ve}else Ln=e,e=ve;if(e===pe){if(e=Ln,t=[],n=Z(),n!==pe)for(;n!==pe;)t.push(n),n=Z();else t=ve;if(t!==pe){if(n=[],o=W(),o!==pe)for(;o!==pe;)n.push(o),o=W();else n=ve;n===pe&&(n=G()),n===pe?(Ln=e,e=ve):(t=[t,n],e=t)}else Ln=e,e=ve;e===pe&&(e=W())}return Sn[l]={nextPos:Ln,result:e},e}function d(){var e,t=49*Ln+2,n=Sn[t];return n?(Ln=n.nextPos,n.result):(e=u(),e===pe&&(e=p(),e===pe&&(e=c(),e===pe&&(e=g()))),Sn[t]={nextPos:Ln,result:e},e)}function u(){var e,n,o,i,r,l,s=49*Ln+3,d=Sn[s];if(d)return Ln=d.nextPos,d.result;if(e=Ln,35===t.charCodeAt(Ln)?(n=ge,Ln++):(n=pe,0===Mn&&a(xe)),n!==pe){for(o=[],i=Ln,r=Ln,Mn++,l=W(),l===pe&&(l=G()),Mn--,l===pe?r=se:(Ln=r,r=ve),r===pe?(Ln=i,i=ve):(t.length>Ln?(l=t.charAt(Ln),Ln++):(l=pe,0===Mn&&a(fe)),l===pe?(Ln=i,i=ve):(r=[r,l],i=r));i!==pe;)o.push(i),i=Ln,r=Ln,Mn++,l=W(),l===pe&&(l=G()),Mn--,l===pe?r=se:(Ln=r,r=ve),r===pe?(Ln=i,i=ve):(t.length>Ln?(l=t.charAt(Ln),Ln++):(l=pe,0===Mn&&a(fe)),l===pe?(Ln=i,i=ve):(r=[r,l],i=r));o===pe?(Ln=e,e=ve):(n=[n,o],e=n)}else Ln=e,e=ve;return Sn[s]={nextPos:Ln,result:e},e}function p(){var e,n,o,i,r,l,s=49*Ln+4,d=Sn[s];if(d)return Ln=d.nextPos,d.result;if(e=Ln,91===t.charCodeAt(Ln)?(n=be,Ln++):(n=pe,0===Mn&&a(me)),n!==pe){for(o=[],i=Z();i!==pe;)o.push(i),i=Z();if(o===pe)Ln=e,e=ve;else if(i=h(),i!==pe){for(r=[],l=Z();l!==pe;)r.push(l),l=Z();r===pe?(Ln=e,e=ve):(93===t.charCodeAt(Ln)?(l=Ae,Ln++):(l=pe,0===Mn&&a(we)),l===pe?(Ln=e,e=ve):(Rn=e,n=ke(i),e=n))}else Ln=e,e=ve}else Ln=e,e=ve;return Sn[s]={nextPos:Ln,result:e},e}function c(){var e,n,o,i,r,l,s,d,u=49*Ln+5,p=Sn[u];if(p)return Ln=p.nextPos,p.result;if(e=Ln,91===t.charCodeAt(Ln)?(n=be,Ln++):(n=pe,0===Mn&&a(me)),n===pe)Ln=e,e=ve;else if(91===t.charCodeAt(Ln)?(o=be,Ln++):(o=pe,0===Mn&&a(me)),o!==pe){for(i=[],r=Z();r!==pe;)i.push(r),r=Z();if(i===pe)Ln=e,e=ve;else if(r=h(),r!==pe){for(l=[],s=Z();s!==pe;)l.push(s),s=Z();l===pe?(Ln=e,e=ve):(93===t.charCodeAt(Ln)?(s=Ae,Ln++):(s=pe,0===Mn&&a(we)),s===pe?(Ln=e,e=ve):(93===t.charCodeAt(Ln)?(d=Ae,Ln++):(d=pe,0===Mn&&a(we)),d===pe?(Ln=e,e=ve):(Rn=e,n=Ce(r),e=n)))}else Ln=e,e=ve}else Ln=e,e=ve;return Sn[u]={nextPos:Ln,result:e},e}function h(){var e,t,n,o=49*Ln+6,i=Sn[o];if(i)return Ln=i.nextPos,i.result;if(e=Ln,t=[],n=v(),n!==pe)for(;n!==pe;)t.push(n),n=v();else t=ve;return t===pe?(Ln=e,e=ve):(n=y(),n===pe?(Ln=e,e=ve):(Rn=e,t=Ee(t,n),e=t)),e===pe&&(e=Ln,t=y(),t!==pe&&(Rn=e,t=Pe(t)),e=t),Sn[o]={nextPos:Ln,result:e},e}function y(){var e,t,n,o,i,r=49*Ln+7,a=Sn[r];if(a)return Ln=a.nextPos,a.result;for(e=Ln,t=[],n=Z();n!==pe;)t.push(n),n=Z();if(t===pe)Ln=e,e=ve;else if(n=x(),n!==pe){for(o=[],i=Z();i!==pe;)o.push(i),i=Z();o===pe?(Ln=e,e=ve):(Rn=e,t=_e(n),e=t)}else Ln=e,e=ve;if(e===pe){for(e=Ln,t=[],n=Z();n!==pe;)t.push(n),n=Z();if(t===pe)Ln=e,e=ve;else if(n=f(),n!==pe){for(o=[],i=Z();i!==pe;)o.push(i),i=Z();o===pe?(Ln=e,e=ve):(Rn=e,t=_e(n),e=t)}else Ln=e,e=ve}return Sn[r]={nextPos:Ln,result:e},e}function v(){var e,n,o,i,r,l,s,d=49*Ln+8,u=Sn[d];if(u)return Ln=u.nextPos,u.result;for(e=Ln,n=[],o=Z();o!==pe;)n.push(o),o=Z();if(n===pe)Ln=e,e=ve;else if(o=x(),o!==pe){for(i=[],r=Z();r!==pe;)i.push(r),r=Z();if(i===pe)Ln=e,e=ve;else if(46===t.charCodeAt(Ln)?(r=Le,Ln++):(r=pe,0===Mn&&a(Re)),r!==pe){for(l=[],s=Z();s!==pe;)l.push(s),s=Z();l===pe?(Ln=e,e=ve):(Rn=e,n=_e(o),e=n)}else Ln=e,e=ve}else Ln=e,e=ve;if(e===pe){for(e=Ln,n=[],o=Z();o!==pe;)n.push(o),o=Z();if(n===pe)Ln=e,e=ve;else if(o=f(),o!==pe){for(i=[],r=Z();r!==pe;)i.push(r),r=Z();if(i===pe)Ln=e,e=ve;else if(46===t.charCodeAt(Ln)?(r=Le,Ln++):(r=pe,0===Mn&&a(Re)),r!==pe){for(l=[],s=Z();s!==pe;)l.push(s),s=Z();l===pe?(Ln=e,e=ve):(Rn=e,n=_e(o),e=n)}else Ln=e,e=ve}else Ln=e,e=ve}return Sn[d]={nextPos:Ln,result:e},e}function g(){var e,n,o,i,r,l,s=49*Ln+9,d=Sn[s];if(d)return Ln=d.nextPos,d.result;if(e=Ln,n=x(),n!==pe){for(o=[],i=Z();i!==pe;)o.push(i),i=Z();if(o===pe)Ln=e,e=ve;else if(61===t.charCodeAt(Ln)?(i=Oe,Ln++):(i=pe,0===Mn&&a(Ve)),i!==pe){for(r=[],l=Z();l!==pe;)r.push(l),l=Z();r===pe?(Ln=e,e=ve):(l=b(),l===pe?(Ln=e,e=ve):(Rn=e,n=Te(n,l),e=n))}else Ln=e,e=ve}else Ln=e,e=ve;if(e===pe)if(e=Ln,n=f(),n!==pe){for(o=[],i=Z();i!==pe;)o.push(i),i=Z();if(o===pe)Ln=e,e=ve;else if(61===t.charCodeAt(Ln)?(i=Oe,Ln++):(i=pe,0===Mn&&a(Ve)),i!==pe){for(r=[],l=Z();l!==pe;)r.push(l),l=Z();r===pe?(Ln=e,e=ve):(l=b(),l===pe?(Ln=e,e=ve):(Rn=e,n=Te(n,l),e=n))}else Ln=e,e=ve}else Ln=e,e=ve;return Sn[s]={nextPos:Ln,result:e},e}function x(){var e,t,n,o=49*Ln+10,i=Sn[o];if(i)return Ln=i.nextPos,i.result;if(e=Ln,t=[],n=J(),n!==pe)for(;n!==pe;)t.push(n),n=J();else t=ve;return t!==pe&&(Rn=e,t=Ie(t)),e=t,Sn[o]={nextPos:Ln,result:e},e}function f(){var e,t,n=49*Ln+11,o=Sn[n];return o?(Ln=o.nextPos,o.result):(e=Ln,t=w(),t!==pe&&(Rn=e,t=Me(t)),e=t,e===pe&&(e=Ln,t=C(),t!==pe&&(Rn=e,t=Me(t)),e=t),Sn[n]={nextPos:Ln,result:e},e)}function b(){var e,t=49*Ln+12,n=Sn[t];return n?(Ln=n.nextPos,n.result):(e=m(),e===pe&&(e=Y(),e===pe&&(e=O(),e===pe&&(e=T(),e===pe&&(e=M(),e===pe&&(e=S(),e===pe&&(e=F())))))),Sn[t]={nextPos:Ln,result:e},e)}function m(){var e,t=49*Ln+13,n=Sn[t];return n?(Ln=n.nextPos,n.result):(e=A(),e===pe&&(e=w(),e===pe&&(e=k(),e===pe&&(e=C()))),Sn[t]={nextPos:Ln,result:e},e)}function A(){var e,n,o,i,r,l=49*Ln+14,s=Sn[l];if(s)return Ln=s.nextPos,s.result;if(e=Ln,t.substr(Ln,3)===Se?(n=Se,Ln+=3):(n=pe,0===Mn&&a(De)),n===pe)Ln=e,e=ve;else if(o=W(),o===pe&&(o=je),o!==pe){for(i=[],r=_();r!==pe;)i.push(r),r=_();i===pe?(Ln=e,e=ve):(t.substr(Ln,3)===Se?(r=Se,Ln+=3):(r=pe,0===Mn&&a(De)),r===pe?(Ln=e,e=ve):(Rn=e,n=Ne(i),e=n))}else Ln=e,e=ve;return Sn[l]={nextPos:Ln,result:e},e}function w(){var e,n,o,i,r=49*Ln+15,l=Sn[r];if(l)return Ln=l.nextPos,l.result;if(e=Ln,34===t.charCodeAt(Ln)?(n=Fe,Ln++):(n=pe,0===Mn&&a(He)),n!==pe){for(o=[],i=E();i!==pe;)o.push(i),i=E();o===pe?(Ln=e,e=ve):(34===t.charCodeAt(Ln)?(i=Fe,Ln++):(i=pe,0===Mn&&a(He)),i===pe?(Ln=e,e=ve):(Rn=e,n=Ne(o),e=n))}else Ln=e,e=ve;return Sn[r]={nextPos:Ln,result:e},e}function k(){var e,n,o,i,r,l=49*Ln+16,s=Sn[l];if(s)return Ln=s.nextPos,s.result;if(e=Ln,t.substr(Ln,3)===$e?(n=$e,Ln+=3):(n=pe,0===Mn&&a(Ue)),n===pe)Ln=e,e=ve;else if(o=W(),o===pe&&(o=je),o!==pe){for(i=[],r=R();r!==pe;)i.push(r),r=R();i===pe?(Ln=e,e=ve):(t.substr(Ln,3)===$e?(r=$e,Ln+=3):(r=pe,0===Mn&&a(Ue)),r===pe?(Ln=e,e=ve):(Rn=e,n=Ne(i),e=n))}else Ln=e,e=ve;return Sn[l]={nextPos:Ln,result:e},e}function C(){var e,n,o,i,r=49*Ln+17,l=Sn[r];if(l)return Ln=l.nextPos,l.result;if(e=Ln,39===t.charCodeAt(Ln)?(n=Be,Ln++):(n=pe,0===Mn&&a(ze)),n!==pe){for(o=[],i=P();i!==pe;)o.push(i),i=P();o===pe?(Ln=e,e=ve):(39===t.charCodeAt(Ln)?(i=Be,Ln++):(i=pe,0===Mn&&a(ze)),i===pe?(Ln=e,e=ve):(Rn=e,n=Ne(o),e=n))}else Ln=e,e=ve;return Sn[r]={nextPos:Ln,result:e},e}function E(){var e,n,o,i=49*Ln+18,r=Sn[i];return r?(Ln=r.nextPos,r.result):(e=te(),e===pe&&(e=Ln,n=Ln,Mn++,34===t.charCodeAt(Ln)?(o=Fe,Ln++):(o=pe,0===Mn&&a(He)),Mn--,o===pe?n=se:(Ln=n,n=ve),n===pe?(Ln=e,e=ve):(t.length>Ln?(o=t.charAt(Ln),Ln++):(o=pe,0===Mn&&a(fe)),o===pe?(Ln=e,e=ve):(Rn=e,n=Xe(o),e=n))),Sn[i]={nextPos:Ln,result:e},e)}function P(){var e,n,o,i=49*Ln+19,r=Sn[i];return r?(Ln=r.nextPos,r.result):(e=Ln,n=Ln,Mn++,39===t.charCodeAt(Ln)?(o=Be,Ln++):(o=pe,0===Mn&&a(ze)),Mn--,o===pe?n=se:(Ln=n,n=ve),n===pe?(Ln=e,e=ve):(t.length>Ln?(o=t.charAt(Ln),Ln++):(o=pe,0===Mn&&a(fe)),o===pe?(Ln=e,e=ve):(Rn=e,n=Xe(o),e=n)),Sn[i]={nextPos:Ln,result:e},e)}function _(){var e,n,o,i=49*Ln+20,r=Sn[i];return r?(Ln=r.nextPos,r.result):(e=te(),e===pe&&(e=L(),e===pe&&(e=Ln,n=Ln,Mn++,t.substr(Ln,3)===Se?(o=Se,Ln+=3):(o=pe,0===Mn&&a(De)),Mn--,o===pe?n=se:(Ln=n,n=ve),n===pe?(Ln=e,e=ve):(t.length>Ln?(o=t.charAt(Ln),Ln++):(o=pe,0===Mn&&a(fe)),o===pe?(Ln=e,e=ve):(Rn=e,n=Ye(o),e=n)))),Sn[i]={nextPos:Ln,result:e},e)}function L(){var e,n,o,i,r,l=49*Ln+21,s=Sn[l];if(s)return Ln=s.nextPos,s.result;if(e=Ln,92===t.charCodeAt(Ln)?(n=Ze,Ln++):(n=pe,0===Mn&&a(We)),n===pe)Ln=e,e=ve;else if(o=W(),o!==pe){for(i=[],r=q();r!==pe;)i.push(r),r=q();i===pe?(Ln=e,e=ve):(Rn=e,n=qe(),e=n)}else Ln=e,e=ve;return Sn[l]={nextPos:Ln,result:e},e}function R(){var e,n,o,i=49*Ln+22,r=Sn[i];return r?(Ln=r.nextPos,r.result):(e=Ln,n=Ln,Mn++,t.substr(Ln,3)===$e?(o=$e,Ln+=3):(o=pe,0===Mn&&a(Ue)),Mn--,o===pe?n=se:(Ln=n,n=ve),n===pe?(Ln=e,e=ve):(t.length>Ln?(o=t.charAt(Ln),Ln++):(o=pe,0===Mn&&a(fe)),o===pe?(Ln=e,e=ve):(Rn=e,n=Xe(o),e=n)),Sn[i]={nextPos:Ln,result:e},e)}function O(){var e,n,o,i,r=49*Ln+23,l=Sn[r];return l?(Ln=l.nextPos,l.result):(e=Ln,n=V(),n===pe&&(n=I()),n===pe?(Ln=e,e=ve):(101===t.charCodeAt(Ln)?(o=Ge,Ln++):(o=pe,0===Mn&&a(Ke)),o===pe&&(69===t.charCodeAt(Ln)?(o=Qe,Ln++):(o=pe,0===Mn&&a(Je))),o===pe?(Ln=e,e=ve):(i=I(),i===pe?(Ln=e,e=ve):(Rn=e,n=et(n,i),e=n))),e===pe&&(e=Ln,n=V(),n!==pe&&(Rn=e,n=tt(n)),e=n),Sn[r]={nextPos:Ln,result:e},e)}function V(){var e,n,o,i,r,l,s=49*Ln+24,d=Sn[s];return d?(Ln=d.nextPos,d.result):(e=Ln,43===t.charCodeAt(Ln)?(n=nt,Ln++):(n=pe,0===Mn&&a(ot)),n===pe&&(n=je),n===pe?(Ln=e,e=ve):(o=Ln,i=ee(),i===pe?(Ln=o,o=ve):(46===t.charCodeAt(Ln)?(r=Le,Ln++):(r=pe,0===Mn&&a(Re)),r===pe?(Ln=o,o=ve):(l=ee(),l===pe?(Ln=o,o=ve):(i=[i,r,l],o=i))),o===pe?(Ln=e,e=ve):(Rn=e,n=it(o),e=n)),e===pe&&(e=Ln,45===t.charCodeAt(Ln)?(n=rt,Ln++):(n=pe,0===Mn&&a(at)),n===pe?(Ln=e,e=ve):(o=Ln,i=ee(),i===pe?(Ln=o,o=ve):(46===t.charCodeAt(Ln)?(r=Le,Ln++):(r=pe,0===Mn&&a(Re)),r===pe?(Ln=o,o=ve):(l=ee(),l===pe?(Ln=o,o=ve):(i=[i,r,l],o=i))),o===pe?(Ln=e,e=ve):(Rn=e,n=lt(o),e=n))),Sn[s]={nextPos:Ln,result:e},e)}function T(){var e,t,n=49*Ln+25,o=Sn[n];return o?(Ln=o.nextPos,o.result):(e=Ln,t=I(),t!==pe&&(Rn=e,t=st(t)),e=t,Sn[n]={nextPos:Ln,result:e},e)}function I(){var e,n,o,i,r,l=49*Ln+26,s=Sn[l];if(s)return Ln=s.nextPos,s.result;if(e=Ln,43===t.charCodeAt(Ln)?(n=nt,Ln++):(n=pe,0===Mn&&a(ot)),n===pe&&(n=je),n!==pe){if(o=[],i=Q(),i!==pe)for(;i!==pe;)o.push(i),i=Q();else o=ve;o===pe?(Ln=e,e=ve):(i=Ln,Mn++,46===t.charCodeAt(Ln)?(r=Le,Ln++):(r=pe,0===Mn&&a(Re)),Mn--,r===pe?i=se:(Ln=i,i=ve),i===pe?(Ln=e,e=ve):(Rn=e,n=it(o),e=n))}else Ln=e,e=ve;if(e===pe)if(e=Ln,45===t.charCodeAt(Ln)?(n=rt,Ln++):(n=pe,0===Mn&&a(at)),n!==pe){if(o=[],i=Q(),i!==pe)for(;i!==pe;)o.push(i),i=Q();else o=ve;o===pe?(Ln=e,e=ve):(i=Ln,Mn++,46===t.charCodeAt(Ln)?(r=Le,Ln++):(r=pe,0===Mn&&a(Re)),Mn--,r===pe?i=se:(Ln=i,i=ve),i===pe?(Ln=e,e=ve):(Rn=e,n=lt(o),e=n))}else Ln=e,e=ve;return Sn[l]={nextPos:Ln,result:e},e}function M(){var e,n,o=49*Ln+27,i=Sn[o];return i?(Ln=i.nextPos,i.result):(e=Ln,t.substr(Ln,4)===dt?(n=dt,Ln+=4):(n=pe,0===Mn&&a(ut)),n!==pe&&(Rn=e,n=pt()),e=n,e===pe&&(e=Ln,t.substr(Ln,5)===ct?(n=ct,Ln+=5):(n=pe,0===Mn&&a(ht)),n!==pe&&(Rn=e,n=yt()),e=n),Sn[o]={nextPos:Ln,result:e},e)}function S(){var e,n,o,i,r,l=49*Ln+28,s=Sn[l];if(s)return Ln=s.nextPos,s.result;if(e=Ln,91===t.charCodeAt(Ln)?(n=be,Ln++):(n=pe,0===Mn&&a(me)),n!==pe){for(o=[],i=N();i!==pe;)o.push(i),i=N();o===pe?(Ln=e,e=ve):(93===t.charCodeAt(Ln)?(i=Ae,Ln++):(i=pe,0===Mn&&a(we)),i===pe?(Ln=e,e=ve):(Rn=e,n=vt(),e=n))}else Ln=e,e=ve;if(e===pe&&(e=Ln,91===t.charCodeAt(Ln)?(n=be,Ln++):(n=pe,0===Mn&&a(me)),n===pe?(Ln=e,e=ve):(o=D(),o===pe&&(o=je),o===pe?(Ln=e,e=ve):(93===t.charCodeAt(Ln)?(i=Ae,Ln++):(i=pe,0===Mn&&a(we)),i===pe?(Ln=e,e=ve):(Rn=e,n=gt(o),e=n))),e===pe)){if(e=Ln,91===t.charCodeAt(Ln)?(n=be,Ln++):(n=pe,0===Mn&&a(me)),n!==pe){if(o=[],i=j(),i!==pe)for(;i!==pe;)o.push(i),i=j();else o=ve;o===pe?(Ln=e,e=ve):(93===t.charCodeAt(Ln)?(i=Ae,Ln++):(i=pe,0===Mn&&a(we)),i===pe?(Ln=e,e=ve):(Rn=e,n=xt(o),e=n))}else Ln=e,e=ve;if(e===pe)if(e=Ln,91===t.charCodeAt(Ln)?(n=be,Ln++):(n=pe,0===Mn&&a(me)),n!==pe){if(o=[],i=j(),i!==pe)for(;i!==pe;)o.push(i),i=j();else o=ve;o===pe?(Ln=e,e=ve):(i=D(),i===pe?(Ln=e,e=ve):(93===t.charCodeAt(Ln)?(r=Ae,Ln++):(r=pe,0===Mn&&a(we)),r===pe?(Ln=e,e=ve):(Rn=e,n=ft(o,i),e=n)))}else Ln=e,e=ve}return Sn[l]={nextPos:Ln,result:e},e}function D(){var e,t,n,o,i,r=49*Ln+29,a=Sn[r];if(a)return Ln=a.nextPos,a.result;for(e=Ln,t=[],n=N();n!==pe;)t.push(n),n=N();if(t===pe)Ln=e,e=ve;else if(n=b(),n!==pe){for(o=[],i=N();i!==pe;)o.push(i),i=N();o===pe?(Ln=e,e=ve):(Rn=e,t=bt(n),e=t)}else Ln=e,e=ve;return Sn[r]={nextPos:Ln,result:e},e}function j(){var e,n,o,i,r,l,s,d=49*Ln+30,u=Sn[d];if(u)return Ln=u.nextPos,u.result;for(e=Ln,n=[],o=N();o!==pe;)n.push(o),o=N();if(n===pe)Ln=e,e=ve;else if(o=b(),o!==pe){for(i=[],r=N();r!==pe;)i.push(r),r=N();if(i===pe)Ln=e,e=ve;else if(44===t.charCodeAt(Ln)?(r=mt,Ln++):(r=pe,0===Mn&&a(At)),r!==pe){for(l=[],s=N();s!==pe;)l.push(s),s=N();l===pe?(Ln=e,e=ve):(Rn=e,n=bt(o),e=n)}else Ln=e,e=ve}else Ln=e,e=ve;return Sn[d]={nextPos:Ln,result:e},e}function N(){var e,t=49*Ln+31,n=Sn[t];return n?(Ln=n.nextPos,n.result):(e=Z(),e===pe&&(e=W(),e===pe&&(e=u())),Sn[t]={nextPos:Ln,result:e},e)}function F(){var e,n,o,i,r,l,s=49*Ln+32,d=Sn[s];if(d)return Ln=d.nextPos,d.result;if(e=Ln,123===t.charCodeAt(Ln)?(n=wt,Ln++):(n=pe,0===Mn&&a(kt)),n!==pe){for(o=[],i=Z();i!==pe;)o.push(i),i=Z();if(o!==pe){for(i=[],r=H();r!==pe;)i.push(r),r=H();if(i!==pe){for(r=[],l=Z();l!==pe;)r.push(l),l=Z();r===pe?(Ln=e,e=ve):(125===t.charCodeAt(Ln)?(l=Ct,Ln++):(l=pe,0===Mn&&a(Et)),l===pe?(Ln=e,e=ve):(Rn=e,n=Pt(i),e=n))}else Ln=e,e=ve}else Ln=e,e=ve}else Ln=e,e=ve;return Sn[s]={nextPos:Ln,result:e},e}function H(){var e,n,o,i,r,l,s,d,u,p,c,h=49*Ln+33,y=Sn[h];if(y)return Ln=y.nextPos,y.result;for(e=Ln,n=[],o=Z();o!==pe;)n.push(o),o=Z();if(n===pe)Ln=e,e=ve;else if(o=x(),o!==pe){for(i=[],r=Z();r!==pe;)i.push(r),r=Z();if(i===pe)Ln=e,e=ve;else if(61===t.charCodeAt(Ln)?(r=Oe,Ln++):(r=pe,0===Mn&&a(Ve)),r!==pe){for(l=[],s=Z();s!==pe;)l.push(s),s=Z();if(l===pe)Ln=e,e=ve;else if(s=b(),s!==pe){for(d=[],u=Z();u!==pe;)d.push(u),u=Z();if(d===pe)Ln=e,e=ve;else if(44===t.charCodeAt(Ln)?(u=mt,Ln++):(u=pe,0===Mn&&a(At)),u!==pe){for(p=[],c=Z();c!==pe;)p.push(c),c=Z();p===pe?(Ln=e,e=ve):(Rn=e,n=_t(o,s),e=n)}else Ln=e,e=ve}else Ln=e,e=ve}else Ln=e,e=ve}else Ln=e,e=ve;if(e===pe){for(e=Ln,n=[],o=Z();o!==pe;)n.push(o),o=Z();if(n===pe)Ln=e,e=ve;else if(o=x(),o!==pe){for(i=[],r=Z();r!==pe;)i.push(r),r=Z();if(i===pe)Ln=e,e=ve;else if(61===t.charCodeAt(Ln)?(r=Oe,Ln++):(r=pe,0===Mn&&a(Ve)),r!==pe){for(l=[],s=Z();s!==pe;)l.push(s),s=Z();l===pe?(Ln=e,e=ve):(s=b(),s===pe?(Ln=e,e=ve):(Rn=e,n=_t(o,s),e=n))}else Ln=e,e=ve}else Ln=e,e=ve}return Sn[h]={nextPos:Ln,result:e},e}function U(){var e,n,o,i=49*Ln+34,r=Sn[i];return r?(Ln=r.nextPos,r.result):(e=Ln,46===t.charCodeAt(Ln)?(n=Le,Ln++):(n=pe,0===Mn&&a(Re)),n===pe?(Ln=e,e=ve):(o=ee(),o===pe?(Ln=e,e=ve):(Rn=e,n=Lt(o),e=n)),Sn[i]={nextPos:Ln,result:e},e)}function B(){var e,n,o,i,r,l,s,d,u,p,c,h,y=49*Ln+35,v=Sn[y];return v?(Ln=v.nextPos,v.result):(e=Ln,n=Ln,o=Q(),o===pe?(Ln=n,n=ve):(i=Q(),i===pe?(Ln=n,n=ve):(r=Q(),r===pe?(Ln=n,n=ve):(l=Q(),l===pe?(Ln=n,n=ve):(45===t.charCodeAt(Ln)?(s=rt,Ln++):(s=pe,0===Mn&&a(at)),s===pe?(Ln=n,n=ve):(d=Q(),d===pe?(Ln=n,n=ve):(u=Q(),u===pe?(Ln=n,n=ve):(45===t.charCodeAt(Ln)?(p=rt,Ln++):(p=pe,0===Mn&&a(at)),p===pe?(Ln=n,n=ve):(c=Q(),c===pe?(Ln=n,n=ve):(h=Q(),h===pe?(Ln=n,n=ve):(o=[o,i,r,l,s,d,u,p,c,h],n=o)))))))))),n!==pe&&(Rn=e,n=Rt(n)),e=n,Sn[y]={nextPos:Ln,result:e},e)}function z(){var e,n,o,i,r,l,s,d,u,p,c,h=49*Ln+36,y=Sn[h];return y?(Ln=y.nextPos,y.result):(e=Ln,n=Ln,o=Q(),o===pe?(Ln=n,n=ve):(i=Q(),i===pe?(Ln=n,n=ve):(58===t.charCodeAt(Ln)?(r=Ot,Ln++):(r=pe,0===Mn&&a(Vt)),r===pe?(Ln=n,n=ve):(l=Q(),l===pe?(Ln=n,n=ve):(s=Q(),s===pe?(Ln=n,n=ve):(58===t.charCodeAt(Ln)?(d=Ot,Ln++):(d=pe,0===Mn&&a(Vt)),d===pe?(Ln=n,n=ve):(u=Q(),u===pe?(Ln=n,n=ve):(p=Q(),p===pe?(Ln=n,n=ve):(c=U(),c===pe&&(c=je),c===pe?(Ln=n,n=ve):(o=[o,i,r,l,s,d,u,p,c],n=o))))))))),n!==pe&&(Rn=e,n=Tt(n)),e=n,Sn[h]={nextPos:Ln,result:e},e)}function X(){var e,n,o,i,r,l,s,d,u,p,c,h,y,v,g,x,f,b=49*Ln+37,m=Sn[b];return m?(Ln=m.nextPos,m.result):(e=Ln,n=Ln,o=Q(),o===pe?(Ln=n,n=ve):(i=Q(),i===pe?(Ln=n,n=ve):(58===t.charCodeAt(Ln)?(r=Ot,Ln++):(r=pe,0===Mn&&a(Vt)),r===pe?(Ln=n,n=ve):(l=Q(),l===pe?(Ln=n,n=ve):(s=Q(),s===pe?(Ln=n,n=ve):(58===t.charCodeAt(Ln)?(d=Ot,Ln++):(d=pe,0===Mn&&a(Vt)),d===pe?(Ln=n,n=ve):(u=Q(),u===pe?(Ln=n,n=ve):(p=Q(),p===pe?(Ln=n,n=ve):(c=U(),c===pe&&(c=je),c===pe?(Ln=n,n=ve):(45===t.charCodeAt(Ln)?(h=rt,Ln++):(h=pe,0===Mn&&a(at)),h===pe&&(43===t.charCodeAt(Ln)?(h=nt,Ln++):(h=pe,0===Mn&&a(ot))),h===pe?(Ln=n,n=ve):(y=Q(),y===pe?(Ln=n,n=ve):(v=Q(),v===pe?(Ln=n,n=ve):(58===t.charCodeAt(Ln)?(g=Ot,Ln++):(g=pe,0===Mn&&a(Vt)),g===pe?(Ln=n,n=ve):(x=Q(),x===pe?(Ln=n,n=ve):(f=Q(),f===pe?(Ln=n,n=ve):(o=[o,i,r,l,s,d,u,p,c,h,y,v,g,x,f],n=o))))))))))))))),n!==pe&&(Rn=e,n=Tt(n)),e=n,Sn[b]={nextPos:Ln,result:e},e)}function Y(){var e,n,o,i,r,l=49*Ln+38,s=Sn[l];return s?(Ln=s.nextPos,s.result):(e=Ln,n=B(),n===pe?(Ln=e,e=ve):(84===t.charCodeAt(Ln)?(o=It,Ln++):(o=pe,0===Mn&&a(Mt)),o===pe?(Ln=e,e=ve):(i=z(),i===pe?(Ln=e,e=ve):(90===t.charCodeAt(Ln)?(r=St,Ln++):(r=pe,0===Mn&&a(Dt)),r===pe?(Ln=e,e=ve):(Rn=e,n=jt(n,i),e=n)))),e===pe&&(e=Ln,n=B(),n===pe?(Ln=e,e=ve):(84===t.charCodeAt(Ln)?(o=It,Ln++):(o=pe,0===Mn&&a(Mt)),o===pe?(Ln=e,e=ve):(i=X(),i===pe?(Ln=e,e=ve):(Rn=e,n=Nt(n,i),e=n)))),Sn[l]={nextPos:Ln,result:e},e)}function Z(){var e,n=49*Ln+39,o=Sn[n];return o?(Ln=o.nextPos,o.result):(Ft.test(t.charAt(Ln))?(e=t.charAt(Ln),Ln++):(e=pe,0===Mn&&a(Ht)),Sn[n]={nextPos:Ln,result:e},e)}function W(){var e,n,o,i=49*Ln+40,r=Sn[i];return r?(Ln=r.nextPos,r.result):(10===t.charCodeAt(Ln)?(e=$t,Ln++):(e=pe,0===Mn&&a(Ut)),e===pe&&(e=Ln,13===t.charCodeAt(Ln)?(n=Bt,Ln++):(n=pe,0===Mn&&a(zt)),n===pe?(Ln=e,e=ve):(10===t.charCodeAt(Ln)?(o=$t,Ln++):(o=pe,0===Mn&&a(Ut)),o===pe?(Ln=e,e=ve):(n=[n,o],e=n))),Sn[i]={nextPos:Ln,result:e},e)}function q(){var e,t=49*Ln+41,n=Sn[t];return n?(Ln=n.nextPos,n.result):(e=W(),e===pe&&(e=Z()),Sn[t]={nextPos:Ln,result:e},e)}function G(){var e,n,o=49*Ln+42,i=Sn[o];return i?(Ln=i.nextPos,i.result):(e=Ln,Mn++,t.length>Ln?(n=t.charAt(Ln),Ln++):(n=pe,0===Mn&&a(fe)),Mn--,n===pe?e=se:(Ln=e,e=ve),Sn[o]={nextPos:Ln,result:e},e)}function K(){var e,n=49*Ln+43,o=Sn[n];return o?(Ln=o.nextPos,o.result):(Xt.test(t.charAt(Ln))?(e=t.charAt(Ln),Ln++):(e=pe,0===Mn&&a(Yt)),Sn[n]={nextPos:Ln,result:e},e)}function Q(){var e,n,o=49*Ln+44,i=Sn[o];return i?(Ln=i.nextPos,i.result):(Zt.test(t.charAt(Ln))?(e=t.charAt(Ln),Ln++):(e=pe,0===Mn&&a(Wt)),e===pe&&(e=Ln,95===t.charCodeAt(Ln)?(n=qt,Ln++):(n=pe,0===Mn&&a(Gt)),n!==pe&&(Rn=e,n=Kt()),e=n),Sn[o]={nextPos:Ln,result:e},e)}function J(){var e,n=49*Ln+45,o=Sn[n];return o?(Ln=o.nextPos,o.result):(Qt.test(t.charAt(Ln))?(e=t.charAt(Ln),Ln++):(e=pe,0===Mn&&a(Jt)),Sn[n]={nextPos:Ln,result:e},e)}function ee(){var e,t,n,o=49*Ln+46,i=Sn[o];if(i)return Ln=i.nextPos,i.result;if(e=Ln,t=[],n=Q(),n!==pe)for(;n!==pe;)t.push(n),n=Q();else t=ve;return t!==pe&&(Rn=e,t=en(t)),e=t,Sn[o]={nextPos:Ln,result:e},e}function te(){var e,n,o=49*Ln+47,i=Sn[o];return i?(Ln=i.nextPos,i.result):(e=Ln,t.substr(Ln,2)===tn?(n=tn,Ln+=2):(n=pe,0===Mn&&a(nn)),n!==pe&&(Rn=e,n=on()),e=n,e===pe&&(e=Ln,t.substr(Ln,2)===rn?(n=rn,Ln+=2):(n=pe,0===Mn&&a(an)),n!==pe&&(Rn=e,n=ln()),e=n,e===pe&&(e=Ln,t.substr(Ln,2)===sn?(n=sn,Ln+=2):(n=pe,0===Mn&&a(dn)),n!==pe&&(Rn=e,n=un()),e=n,e===pe&&(e=Ln,t.substr(Ln,2)===pn?(n=pn,Ln+=2):(n=pe,0===Mn&&a(cn)),n!==pe&&(Rn=e,n=hn()),e=n,e===pe&&(e=Ln,t.substr(Ln,2)===yn?(n=yn,Ln+=2):(n=pe,0===Mn&&a(vn)),n!==pe&&(Rn=e,n=gn()),e=n,e===pe&&(e=Ln,t.substr(Ln,2)===xn?(n=xn,Ln+=2):(n=pe,0===Mn&&a(fn)),n!==pe&&(Rn=e,n=bn()),e=n,e===pe&&(e=Ln,t.substr(Ln,2)===mn?(n=mn,Ln+=2):(n=pe,0===Mn&&a(An)),n!==pe&&(Rn=e,n=wn()),e=n,e===pe&&(e=ne()))))))),Sn[o]={nextPos:Ln,result:e},e)}function ne(){var e,n,o,i,r,l,s,d,u,p,c,h=49*Ln+48,y=Sn[h];return y?(Ln=y.nextPos,y.result):(e=Ln,t.substr(Ln,2)===kn?(n=kn,Ln+=2):(n=pe,0===Mn&&a(Cn)),n===pe?(Ln=e,e=ve):(o=Ln,i=K(),i===pe?(Ln=o,o=ve):(r=K(),r===pe?(Ln=o,o=ve):(l=K(),l===pe?(Ln=o,o=ve):(s=K(),s===pe?(Ln=o,o=ve):(d=K(),d===pe?(Ln=o,o=ve):(u=K(),u===pe?(Ln=o,o=ve):(p=K(),p===pe?(Ln=o,o=ve):(c=K(),c===pe?(Ln=o,o=ve):(i=[i,r,l,s,d,u,p,c],o=i)))))))),o===pe?(Ln=e,e=ve):(Rn=e,n=En(o),e=n)),e===pe&&(e=Ln,t.substr(Ln,2)===Pn?(n=Pn,Ln+=2):(n=pe,0===Mn&&a(_n)),n===pe?(Ln=e,e=ve):(o=Ln,i=K(),i===pe?(Ln=o,o=ve):(r=K(),r===pe?(Ln=o,o=ve):(l=K(),l===pe?(Ln=o,o=ve):(s=K(),s===pe?(Ln=o,o=ve):(i=[i,r,l,s],o=i)))),o===pe?(Ln=e,e=ve):(Rn=e,n=En(o),e=n))),Sn[h]={nextPos:Ln,result:e},e)}function oe(e,t,n){var o=new Error(e);throw o.line=t,o.column=n,o}function ie(e){Dn.push(e)}function re(e,t,n,o,i){var r={type:e,value:t,line:n(),column:o()};return i&&(r.key=i),r}function ae(e,t,n){var o=parseInt('0x'+e);return!isFinite(o)||r(o)!=o||0>o||1114111<o||55295<o&&57344>o?void oe('Invalid Unicode escape code: '+e,t,n):le(o)}function le(){var e,t,n=[],o=-1,i=arguments.length;if(!i)return'';for(var r,a='';++o<i;)r=+arguments[o],65535>=r?n.push(r):(r-=65536,e=(r>>10)+55296,t=r%1024+56320,n.push(e,t)),(o+1==i||n.length>16384)&&(a+=String.fromCharCode.apply(null,n),n.length=0);return a}var se,de,ue=1<arguments.length?arguments[1]:{},pe={},ce={start:l},he=l,ye=function(){return Dn},ve=pe,ge='#',xe={type:'literal',value:'#',description:'"#"'},fe={type:'any',description:'any character'},be='[',me={type:'literal',value:'[',description:'"["'},Ae=']',we={type:'literal',value:']',description:'"]"'},ke=function(e){ie(re('ObjectPath',e,n,o))},Ce=function(e){ie(re('ArrayPath',e,n,o))},Ee=function(e,t){return e.concat(t)},Pe=function(e){return[e]},_e=function(e){return e},Le='.',Re={type:'literal',value:'.',description:'"."'},Oe='=',Ve={type:'literal',value:'=',description:'"="'},Te=function(e,t){ie(re('Assign',t,n,o,e))},Ie=function(e){return e.join('')},Me=function(e){return e.value},Se='"""',De={type:'literal',value:'"""',description:'"\\"\\"\\""'},je=null,Ne=function(e){return re('String',e.join(''),n,o)},Fe='"',He={type:'literal',value:'"',description:'"\\""'},$e='\'\'\'',Ue={type:'literal',value:'\'\'\'',description:'"\'\'\'"'},Be='\'',ze={type:'literal',value:'\'',description:'"\'"'},Xe=function(e){return e},Ye=function(e){return e},Ze='\\',We={type:'literal',value:'\\',description:'"\\\\"'},qe=function(){return''},Ge='e',Ke={type:'literal',value:'e',description:'"e"'},Qe='E',Je={type:'literal',value:'E',description:'"E"'},et=function(e,t){return re('Float',parseFloat(e+'e'+t),n,o)},tt=function(e){return re('Float',parseFloat(e),n,o)},nt='+',ot={type:'literal',value:'+',description:'"+"'},it=function(e){return e.join('')},rt='-',at={type:'literal',value:'-',description:'"-"'},lt=function(e){return'-'+e.join('')},st=function(e){return re('Integer',parseInt(e,10),n,o)},dt='true',ut={type:'literal',value:'true',description:'"true"'},pt=function(){return re('Boolean',!0,n,o)},ct='false',ht={type:'literal',value:'false',description:'"false"'},yt=function(){return re('Boolean',!1,n,o)},vt=function(){return re('Array',[],n,o)},gt=function(e){return re('Array',e?[e]:[],n,o)},xt=function(e){return re('Array',e,n,o)},ft=function(e,t){return re('Array',e.concat(t),n,o)},bt=function(e){return e},mt=',',At={type:'literal',value:',',description:'","'},wt='{',kt={type:'literal',value:'{',description:'"{"'},Ct='}',Et={type:'literal',value:'}',description:'"}"'},Pt=function(e){return re('InlineTable',e,n,o)},_t=function(e,t){return re('InlineTableValue',t,n,o,e)},Lt=function(e){return'.'+e},Rt=function(e){return e.join('')},Ot=':',Vt={type:'literal',value:':',description:'":"'},Tt=function(e){return e.join('')},It='T',Mt={type:'literal',value:'T',description:'"T"'},St='Z',Dt={type:'literal',value:'Z',description:'"Z"'},jt=function(e,t){return re('Date',new Date(e+'T'+t+'Z'),n,o)},Nt=function(e,t){return re('Date',new Date(e+'T'+t),n,o)},Ft=/^[ \t]/,Ht={type:'class',value:'[ \\t]',description:'[ \\t]'},$t='\n',Ut={type:'literal',value:'\n',description:'"\\n"'},Bt='\r',zt={type:'literal',value:'\r',description:'"\\r"'},Xt=/^[0-9a-f]/i,Yt={type:'class',value:'[0-9a-f]i',description:'[0-9a-f]i'},Zt=/^[0-9]/,Wt={type:'class',value:'[0-9]',description:'[0-9]'},qt='_',Gt={type:'literal',value:'_',description:'"_"'},Kt=function(){return''},Qt=/^[A-Za-z0-9_\-]/,Jt={type:'class',value:'[A-Za-z0-9_\\-]',description:'[A-Za-z0-9_\\-]'},en=function(e){return e.join('')},tn='\\"',nn={type:'literal',value:'\\"',description:'"\\\\\\""'},on=function(){return'"'},rn='\\\\',an={type:'literal',value:'\\\\',description:'"\\\\\\\\"'},ln=function(){return'\\'},sn='\\b',dn={type:'literal',value:'\\b',description:'"\\\\b"'},un=function(){return'\b'},pn='\\t',cn={type:'literal',value:'\\t',description:'"\\\\t"'},hn=function(){return'\t'},yn='\\n',vn={type:'literal',value:'\\n',description:'"\\\\n"'},gn=function(){return'\n'},xn='\\f',fn={type:'literal',value:'\\f',description:'"\\\\f"'},bn=function(){return'\f'},mn='\\r',An={type:'literal',value:'\\r',description:'"\\\\r"'},wn=function(){return'\r'},kn='\\U',Cn={type:'literal',value:'\\U',description:'"\\\\U"'},En=function(e){return ae(e.join(''))},Pn='\\u',_n={type:'literal',value:'\\u',description:'"\\\\u"'},Ln=0,Rn=0,On=0,Vn={line:1,column:1,seenCR:!1},Tn=0,In=[],Mn=0,Sn={};if('startRule'in ue){if(!(ue.startRule in ce))throw new Error('Can\'t start parsing from rule "'+ue.startRule+'".');he=ce[ue.startRule]}var Dn=[];if(de=he(),de!==pe&&Ln===t.length)return de;throw de!==pe&&Ln<t.length&&a({type:'end',description:'end of input'}),function(n,o,r){var a=i(r),l=r<t.length?t.charAt(r):null;return null!==o&&function(e){var t=1;for(e.sort(function(e,t){return e.description<t.description?-1:e.description>t.description?1:0});t<e.length;)e[t-1]===e[t]?e.splice(t,1):t++}(o),new e(null===n?function(e,t){var n,o,r,i=Array(e.length);for(r=0;r<e.length;r++)i[r]=e[r].description;return n=1<e.length?i.slice(0,-1).join(', ')+' or '+i[e.length-1]:i[0],o=t?'"'+function(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,'\\\\').replace(/"/g,'\\"').replace(/\x08/g,'\\b').replace(/\t/g,'\\t').replace(/\n/g,'\\n').replace(/\f/g,'\\f').replace(/\r/g,'\\r').replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(e){return'\\x0'+t(e)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(e){return'\\x'+t(e)}).replace(/[\u0180-\u0FFF]/g,function(e){return'\\u0'+t(e)}).replace(/[\u1080-\uFFFF]/g,function(e){return'\\u'+t(e)})}(t)+'"':'end of input','Expected '+n+' but '+o+' found.'}(o,l):n,o,l,r,a.line,a.column)}(null,In,Tn)}return function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}(e,Error),{SyntaxError:e,parse:t}}()},function(e){'use strict';e.exports={compile:function(e){function t(e,t,n){var o=new Error(e);throw o.line=t,o.column=n,o}function n(e){var n,i=e.key,a=e.value,l=e.line,s=e.column;n=h?h+'.'+i:i,'undefined'!=typeof v[i]&&t('Cannot redefine existing key \''+n+'\'.',l,s),v[i]=r(a),o(n)||(p.push(n),c.push(n))}function o(e){return-1!==p.indexOf(e)}function r(e){return'Array'===e.type?d(e.value):'InlineTable'===e.type?a(e.value):e.value}function a(e){for(var t,n={},o=0;o<e.length;o++)t=e[o],'InlineTable'===t.value.type?n[t.key]=a(t.value.value):'InlineTableValue'===t.type&&(n[t.key]=r(t.value));return n}function l(e){var n=e.value,r=n.map(u).join('.'),a=e.line,l=e.column;o(r)&&t('Cannot redefine existing key \''+n+'\'.',a,l),p.push(r),v=i(y,n,{},a,l),h=n}function s(e){var n=e.value,r=n.map(u).join('.'),a=e.line,l=e.column;if(o(r)||p.push(r),p=p.filter(function(e){return 0!==e.indexOf(r)}),p.push(r),v=i(y,n,[],a,l),h=r,v instanceof Array){var s={};v.push(s),v=s}else t('Cannot redefine existing key \''+n+'\'.',a,l)}function i(e,n,o,r,a){var l,s=[],d='',u=n.join('.'),p=e,h=n.length;for(var y in n)l=n[y],s.push(l),d=s.join('.'),'undefined'==typeof p[l]?y===h-1+''?p[l]=o:p[l]={}:y!==h-1&&-1<c.indexOf(d)&&t('Cannot redefine existing key \''+d+'\'.',r,a),p=p[l],p instanceof Array&&p.length&&y<n.length-1&&(p=p[p.length-1]);return p}function d(e){var n=null;for(var o in e){var i=e[o];null===n?n=i.type:('Integer'===i.type||'Float'===i.type)&&('Integer'===n||'Float'===n)||i.type!==n&&t('Cannot add value of type '+i.type+' to array of type '+n+'.',i.line,i.column)}return e.map(r)}function u(e){return-1<e.indexOf('.')?'"'+e+'"':e}var p=[],c=[],h='',y={},v=y;return function(e){var t;for(var o in e)switch(t=e[o],t.type){case'Assign':n(t);break;case'ObjectPath':l(t);break;case'ArrayPath':s(t);}return y}(e)}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){'use strict';var o=n(4),i=n(49),r=n(1);class l extends i.a{constructor(){super(),this.uuid=null,this.type='span',this.rectangles=[],this.text=null,this.color=null,this.readOnly=!1,this.selectedText=null,this.textRange=null,this.page=null,this.knob=!0,this.$element=this.createDummyElement(),window.globalEvent.on('deleteSelectedAnnotation',this.deleteSelectedAnnotation),window.globalEvent.on('enableViewMode',this.enableViewMode)}static newInstance(e){console.log('newInstance:',e.selectedText);let t=new l;return t.uuid=e.uuid||o.a(),t.rectangles=e.rectangles,t.text=e.text,t.color=e.color,t.readOnly=e.readOnly||!1,t.selectedText=e.selectedText,t.textRange=e.textRange,t.page=e.page,t.zIndex=e.zIndex||10,t.knob='boolean'!=typeof e.knob||e.knob,console.log('newInstance',t.knob,e.knob),t}static newInstanceFromTomlObject(e){let t=e,n=t.position.map((e)=>e.map(parseFloat));t.selectedText=t.text,t.text=t.label,t.textRange=t.textrange,t.rectangles=n.map((e)=>({x:e[0],y:e[1],width:e[2],height:e[3]}));let o=l.newInstance(t);return o}setHoverEvent(){this.$element.find('.anno-knob').hover(this.handleHoverInEvent,this.handleHoverOutEvent)}destroy(){let e=super.destroy();return this.emit('delete'),window.globalEvent.removeListener('deleteSelectedAnnotation',this.deleteSelectedAnnotation),window.globalEvent.removeListener('enableViewMode',this.enableViewMode),e}createAnnotation(){return{uuid:this.uuid,type:this.type,rectangles:this.rectangles,text:this.text,color:this.color,readyOnly:this.readOnly,selectedText:this.selectedText}}getTextPosition(){let e=null;return 0<this.rectangles.length&&(e={x:this.rectangles[0].x+7,y:this.rectangles[0].y-20}),e}deleteSelectedAnnotation(){super.deleteSelectedAnnotation()}handleTextSelected(){this.select()}handleTextDeselected(){this.deselect()}handleTextHoverIn(){this.highlight(),this.emit('hoverin')}handleTextHoverOut(){this.dehighlight(),this.emit('hoverout')}handleTextChanged(e){this.text=e,this.save()}handleHoverInEvent(t){super.handleHoverInEvent(t),this.emit('circlehoverin',this)}handleHoverOutEvent(t){super.handleHoverOutEvent(t),this.emit('circlehoverout',this)}handleClickEvent(t){super.handleClickEvent(t)}enableViewMode(){this.disableViewMode(),super.enableViewMode(),this.readOnly||this.$element.find('.anno-knob').on('click',this.handleClickEvent)}disableViewMode(){super.disableViewMode(),this.$element.find('.anno-knob').off('click')}}t.a=l},function(e,t,n){'use strict';var o=n(54),i=n.n(o),r=n(75),a=n(60);class l extends i.a{static isAnnotation(e){return e&&e.uuid&&e.type}constructor(){super(),this.autoBind(),this.deleted=!1,this.selected=!1,this.selectedTime=null,this.createdAt=new Date().getTime()}autoBind(){Object.getOwnPropertyNames(this.constructor.prototype).filter((e)=>'function'==typeof this[e]).forEach((e)=>{this[e]=this[e].bind(this)})}render(){if(this.$element.remove(),this.deleted)return!1;const e=$('#annoLayer2')[0];return this.$element=$(r.a(e,this)),!this.hoverEventDisable&&this.setHoverEvent&&this.setHoverEvent(),this.selected&&this.$element.addClass('--selected'),this.disabled&&this.disable(),!0}save(){window.annotationContainer.add(this)}destroy(){this.deleted=!0,this.$element.remove();let e=Promise.resolve();return this.uuid&&window.annotationContainer.remove(this),e}isHit(){return!1}handleClickEvent(){if(this.toggleSelect(),'textbox'!==this.type)if(this.selected){let e=document.createEvent('CustomEvent');e.initCustomEvent('annotationSelected',!0,!0,this),window.dispatchEvent(e)}else{let e=document.createEvent('CustomEvent');e.initCustomEvent('annotationDeselected',!0,!0,this),window.dispatchEvent(e)}}handleHoverInEvent(){console.log('handleHoverInEvent'),this.highlight(),this.emit('hoverin'),a.a('annotationHoverIn',this)}handleHoverOutEvent(){console.log('handleHoverOutEvent'),this.dehighlight(),this.emit('hoverout'),a.a('annotationHoverOut',this)}highlight(){this.$element.addClass('--hover')}dehighlight(){this.$element.removeClass('--hover')}select(){this.selected=!0,this.selectedTime=Date.now(),this.$element.addClass('--selected')}deselect(){console.log('deselect'),this.selected=!1,this.selectedTime=null,this.$element.removeClass('--selected')}toggleSelect(){this.selected?this.deselect():this.select()}deleteSelectedAnnotation(){return!!this.isSelected()&&(this.destroy().then(()=>{a.a('annotationDeleted',{uuid:this.uuid})}),!0)}isSelected(){return this.$element.hasClass('--selected')}createDummyElement(){return $('<div class="dummy"/>')}getBoundingCirclePosition(){const e=this.$element.find('.anno-knob');return 0<e.length?{x:parseFloat(e.css('left'))+parseFloat(e.css('width'))/2,y:parseFloat(e.css('top'))+parseFloat(e.css('height'))/2}:null}enableViewMode(){this.render()}disableViewMode(){this.render()}setDisableHoverEvent(){this.hoverEventDisable=!0}setEnableHoverEvent(){this.hoverEventDisable=!1}enable(){this.disabled=!1,this.$element.css('pointer-events','auto')}disable(){this.disabled=!0,this.$element.css('pointer-events','none')}equalTo(){return!1}}t.a=l},function(e,t){'use strict';function n(e,t,n){for(const o=$('.anno-knob');;){let i=!0;if(o.each(function(){var o=Math.pow;const r=$(this),a=parseInt(r.css('left')),l=parseInt(r.css('top')),s=o(e-a,2)+o(t-l,2),d=o(n,2);s<d&&(i=!1)}),i)break;t-=1}return[e,t]}t.b=function({x:e,y:t,readOnly:i}){[e,t]=n(e,t-(o+2),o);let r='anno-knob';return i&&(r+=' is-readonly'),$(`<div class="${r}"/>`).css({top:`${t}px`,left:`${e}px`,width:o+'px',height:o+'px'})};const o=7;t.a=o},function(e,t,n){'use strict';var o=n(4),i=n(49),r=n(59),a=n(2);let l;class s extends i.a{constructor(){super(),l=window.globalEvent,this.uuid=o.a(),this.type='relation',this.direction=null,this.rel1Annotation=null,this.rel2Annotation=null,this.text=null,this.color=null,this.readOnly=!1,this.$element=this.createDummyElement(),this.x1=0,this.y1=0,this.x2=0,this.y2=0,l.on('deleteSelectedAnnotation',this.deleteSelectedAnnotation),l.on('enableViewMode',this.enableViewMode),l.on('rectmoveend',this.handleRelMoveEnd)}static newInstance(e){let t=new s;return t.uuid=e.uuid||o.a(),t.direction=e.direction,t.rel1Annotation=i.a.isAnnotation(e.rel1)?e.rel1:window.annotationContainer.findById(e.rel1),t.rel2Annotation=i.a.isAnnotation(e.rel2)?e.rel2:window.annotationContainer.findById(e.rel2),t.text=e.text,t.color=e.color,t.readOnly=e.readOnly||!1,t.zIndex=e.zIndex||10,t}static newInstanceFromTomlObject(e){e.direction=e.dir,e.text=e.label;let t=s.newInstance(e);return t}setHoverEvent(){this.$element.find('path').hover(this.handleHoverInEvent,this.handleHoverOutEvent)}set rel1Annotation(e){this._rel1Annotation=e,this._rel1Annotation&&(this._rel1Annotation.on('hoverin',this.handleRelHoverIn),this._rel1Annotation.on('hoverout',this.handleRelHoverOut),this._rel1Annotation.on('rectmove',this.handleRelMove),this._rel1Annotation.on('delete',this.handleRelDelete))}get rel1Annotation(){return this._rel1Annotation}set rel2Annotation(e){this._rel2Annotation=e,this._rel2Annotation&&(this._rel2Annotation.on('hoverin',this.handleRelHoverIn),this._rel2Annotation.on('hoverout',this.handleRelHoverOut),this._rel2Annotation.on('rectmove',this.handleRelMove),this._rel2Annotation.on('delete',this.handleRelDelete))}get rel2Annotation(){return this._rel2Annotation}render(){this.setStartEndPosition(),super.render()}createAnnotation(){return{uuid:this.uuid,type:this.type,direction:this.direction,rel1:this._rel1Annotation.uuid,rel2:this._rel2Annotation.uuid,text:this.text,color:this.color,readOnly:this.readOnly}}destroy(){let e=super.destroy();return this._rel1Annotation&&(this._rel1Annotation.removeListener('hoverin',this.handleRelHoverIn),this._rel1Annotation.removeListener('hoverout',this.handleRelHoverOut),this._rel1Annotation.removeListener('rectmove',this.handleRelMove),this._rel1Annotation.removeListener('delete',this.handleRelDelete),delete this._rel1Annotation),this._rel2Annotation&&(this._rel2Annotation.removeListener('hoverin',this.handleRelHoverIn),this._rel2Annotation.removeListener('hoverout',this.handleRelHoverOut),this._rel2Annotation.removeListener('rectmove',this.handleRelMove),this._rel2Annotation.removeListener('delete',this.handleRelDelete),delete this._rel2Annotation),l.removeListener('deleteSelectedAnnotation',this.deleteSelectedAnnotation),l.removeListener('enableViewMode',this.enableViewMode),l.removeListener('rectmoveend',this.handleRelMoveEnd),e}deleteSelectedAnnotation(){super.deleteSelectedAnnotation()}getTextPosition(){return this.setStartEndPosition(),r.b(this.x1,this.y1,this.x2,this.y2,this.text,this.uuid)}highlightRelAnnotations(){this._rel1Annotation&&this._rel1Annotation.highlight(),this._rel2Annotation&&this._rel2Annotation.highlight()}dehighlightRelAnnotations(){this._rel1Annotation&&this._rel1Annotation.dehighlight(),this.rel2Annotation&&this.rel2Annotation.dehighlight()}handleTextSelected(){this.select()}handleTextDeselected(){this.deselect()}handleTextHoverIn(){this.highlight(),this.emit('hoverin'),this.highlightRelAnnotations()}handleTextHoverOut(){this.dehighlight(),this.emit('hoverout'),this.dehighlightRelAnnotations()}handleRelHoverIn(){this.highlight(),this.highlightRelAnnotations()}handleRelHoverOut(){this.dehighlight(),this.dehighlightRelAnnotations()}handleRelDelete(){this.destroy()}handleRelMove(){this.render()}handleRelMoveEnd(e){(this._rel1Annotation===e||this._rel2Annotation===e)&&this.enableViewMode()}handleTextChanged(e){this.text=e,this.save()}handleHoverInEvent(t){super.handleHoverInEvent(t),this.highlightRelAnnotations()}handleHoverOutEvent(t){super.handleHoverOutEvent(t),this.dehighlightRelAnnotations()}handleClickEvent(t){super.handleClickEvent(t)}enableViewMode(){this.disableViewMode(),super.enableViewMode(),this.readOnly||this.$element.find('path').on('click',this.handleClickEvent)}disableViewMode(){super.disableViewMode(),this.$element.find('path').off('click')}setStartEndPosition(){if(this._rel1Annotation){let e=this._rel1Annotation.getBoundingCirclePosition();this.x1=e.x,this.y1=e.y}if(this._rel2Annotation){let e=this._rel2Annotation.getBoundingCirclePosition();this.x2=e.x,this.y2=e.y}}equalTo(e){if(!e||this.type!==e)return!1;const t=a.a(this.rel1Annotation.uuid,[e.rel1Annotation.uuid,e.rel2Annotation.uuid])&&a.a(this.rel2Annotation.uuid,[e.rel1Annotation.uuid,e.rel2Annotation.uuid]);return t}}t.a=s},,,function(e){function t(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return'function'==typeof e}function o(e){return'number'==typeof e}function r(e){return'object'==typeof e&&null!==e}function a(e){return void 0===e}e.exports=t,t.EventEmitter=t,t.prototype._events=void 0,t.prototype._maxListeners=void 0,t.defaultMaxListeners=10,t.prototype.setMaxListeners=function(e){if(!o(e)||0>e||isNaN(e))throw TypeError('n must be a positive number');return this._maxListeners=e,this},t.prototype.emit=function(e){var t,o,l,s,d,i;if(this._events||(this._events={}),'error'===e&&(!this._events.error||r(this._events.error)&&!this._events.error.length))if(t=arguments[1],t instanceof Error)throw t;else{var u=new Error('Uncaught, unspecified "error" event. ('+t+')');throw u.context=t,u}if(o=this._events[e],a(o))return!1;if(n(o))switch(arguments.length){case 1:o.call(this);break;case 2:o.call(this,arguments[1]);break;case 3:o.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),o.apply(this,s);}else if(r(o))for(s=Array.prototype.slice.call(arguments,1),i=o.slice(),l=i.length,d=0;d<l;d++)i[d].apply(this,s);return!0},t.prototype.addListener=function(e,o){var i;if(!n(o))throw TypeError('listener must be a function');return this._events||(this._events={}),this._events.newListener&&this.emit('newListener',e,n(o.listener)?o.listener:o),this._events[e]?r(this._events[e])?this._events[e].push(o):this._events[e]=[this._events[e],o]:this._events[e]=o,r(this._events[e])&&!this._events[e].warned&&(i=a(this._maxListeners)?t.defaultMaxListeners:this._maxListeners,i&&0<i&&this._events[e].length>i&&(this._events[e].warned=!0,console.error('(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.',this._events[e].length),'function'==typeof console.trace&&console.trace())),this},t.prototype.on=t.prototype.addListener,t.prototype.once=function(e,t){function o(){this.removeListener(e,o),i||(i=!0,t.apply(this,arguments))}if(!n(t))throw TypeError('listener must be a function');var i=!1;return o.listener=t,this.on(e,o),this},t.prototype.removeListener=function(e,t){var o,a,l,s;if(!n(t))throw TypeError('listener must be a function');if(!this._events||!this._events[e])return this;if(o=this._events[e],l=o.length,a=-1,o===t||n(o.listener)&&o.listener===t)delete this._events[e],this._events.removeListener&&this.emit('removeListener',e,t);else if(r(o)){for(s=l;0<s--;)if(o[s]===t||o[s].listener&&o[s].listener===t){a=s;break}if(0>a)return this;1===o.length?(o.length=0,delete this._events[e]):o.splice(a,1),this._events.removeListener&&this.emit('removeListener',e,t)}return this},t.prototype.removeAllListeners=function(e){var t,o;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)'removeListener'!==t&&this.removeAllListeners(t);return this.removeAllListeners('removeListener'),this._events={},this}if(o=this._events[e],n(o))this.removeListener(e,o);else if(o)for(;o.length;)this.removeListener(e,o[o.length-1]);return delete this._events[e],this},t.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[],t},t.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;if(t)return t.length}return 0},t.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t){'use strict';t.c=function(e){2===arguments.length&&(e=arguments[1]);let t={};const n=window.PDFView.pdfViewer.getPageView(0).viewport;return Object.keys(e).forEach((o)=>{t[o]=e[o]/n.scale}),t},t.a=function(){$('body').addClass('disable-text-layer')},t.b=function(){$('body').removeClass('disable-text-layer')}},function(e,t){'use strict';t.a=function(e,t=1){let n=e.match(/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i),o=null;return n&&(o=n.slice(1,4).map(function(e){return parseInt(e,16)})),n=e.match(/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i),n&&(o=n.slice(1,4).map(function(e){return 17*parseInt(e,16)})),o?`rgba(${o[0]}, ${o[1]}, ${o[2]}, ${t})`:e}},function(e,t,n){'use strict';let o=n(78),i=o.version;t.a=i},function(e,t){'use strict';t.a=function(e,t){Object.keys(t).forEach((n)=>{e.setAttribute(i(n),t[n])})};const n=/[A-Z]/g,o=['viewBox'];let i=(e)=>(-1===o.indexOf(e)&&(e=e.replace(n,(e)=>'-'+e.toLowerCase())),e)},function(e,r){'use strict';function a(e,r,a,l){const s=30;if(e===a)return{x:e,y:(r+l)/2};if(r===l)return{x:(e+a)/2,y:r-s};let d={x:(e+a)/2,y:(r+l)/2},u=(r-l)/(e-a);u=-1/u;let p=i(u),c=o(p)*s,h=n(p)*s;return e<a?r>l?{x:d.x-t(c),y:d.y-t(h)}:{x:d.x+t(c),y:d.y-t(h)}:r>l?{x:d.x+t(c),y:d.y-t(h)}:{x:d.x-t(c),y:d.y-t(h)}}r.a=a,r.b=function(e,t,n,o,i='',r=null){let l=[];$('.anno-text').each(function(){let e=$(this);e.parent().data('parent-id')!==r&&l.push({x:parseFloat(e.attr('x')),y:parseFloat(e.attr('y')),width:parseFloat(e.attr('width')),height:parseFloat(e.attr('height'))})});let s=5;for(t<o&&(s*=-1);;){let i=a(e,t,n,o),d=n+.4*(i.x-n),u=o+.4*(i.y-o),r=!0;for(let e=0;e<l.length;e++){let t=l[e],n=t.x,o=t.x+t.width,i=t.y,a=t.y+t.height;if(n<=d+200&&d<=o&&i<=u+15&&u<=a){r=!1;break}}if(r)return{x:d,y:u};t+=s,o+=s}}},function(e,t){'use strict';t.a=function(e,t){var n=document.createEvent('CustomEvent');n.initCustomEvent(e,!0,!0,t),window.dispatchEvent(n)}},function(e,t){'use strict';t.a=function({uuid:e,text:t,disable:n=!1,autoFocus:o=!1,blurListener:i=null}){var r=document.createEvent('CustomEvent');r.initCustomEvent('enableTextInput',!0,!0,...arguments),window.dispatchEvent(r),console.log('dispatchEvent:',r,arguments[0])}},function(e,t,n){'use strict';var o=n(4),i=n(49),r=n(55),a=n(1);let l;class s extends i.a{constructor(){super(),l=window.globalEvent,this.uuid=null,this.type='rect',this.x=0,this.y=0,this.width=0,this.height=0,this.text=null,this.color=null,this.readOnly=!1,this.$element=this.createDummyElement(),l.on('deleteSelectedAnnotation',this.deleteSelectedAnnotation),l.on('enableViewMode',this.enableViewMode)}static newInstance(e){let t=new s;return t.uuid=e.uuid||o.a(),t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,t.text=e.text,t.color=e.color,t.readOnly=e.readOnly||!1,t.zIndex=e.zIndex||10,t}static newInstanceFromTomlObject(e){let t=e;t.position=t.position.map(parseFloat),t.x=t.position[0],t.y=a.a(t.page,t.position[1]),t.width=t.position[2],t.height=t.position[3],t.text=t.label;let n=s.newInstance(t);return n}setHoverEvent(){this.$element.find('.anno-rect, .anno-knob').hover(this.handleHoverInEvent,this.handleHoverOutEvent)}destroy(){let e=super.destroy();return this.emit('delete'),window.globalEvent.removeListener('deleteSelectedAnnotation',this.deleteSelectedAnnotation),window.globalEvent.removeListener('enableViewMode',this.enableViewMode),e}createAnnotation(){return{uuid:this.uuid,type:this.type,x:this.x,y:this.y,width:this.width,height:this.height,text:this.text,color:this.color,readyOnly:this.readOnly}}deleteSelectedAnnotation(){super.deleteSelectedAnnotation()}getTextPosition(){return{x:this.x+7,y:this.y-20}}handleTextSelected(){this.select()}handleTextDeselected(){this.deselect()}handleTextHoverIn(){this.highlight(),this.emit('hoverin')}handleTextHoverOut(){this.dehighlight(),this.emit('hoverout')}handleTextChanged(e){console.log('rect:handleTextChanged:',e),this.text=e,this.save()}handleHoverInEvent(t){super.handleHoverInEvent(t);let e=$(t.currentTarget);'circle'===e.prop('tagName')&&this.emit('circlehoverin',this)}handleHoverOutEvent(t){super.handleHoverOutEvent(t);let e=$(t.currentTarget);'circle'===e.prop('tagName')&&this.emit('circlehoverout',this)}handleClickEvent(t){super.handleClickEvent(t)}handleMouseDownOnRect(){console.log('handleMouseDownOnRect'),this.originalX=this.x,this.originalY=this.y,document.addEventListener('mousemove',this.handleMouseMoveOnDocument),document.addEventListener('mouseup',this.handleMouseUpOnDocument),window.globalEvent.emit('rectmovestart'),r.a()}handleMouseMoveOnDocument(t){this._dragging=!0,this.startX||(this.startX=parseInt(t.clientX),this.startY=parseInt(t.clientY)),this.endX=parseInt(t.clientX),this.endY=parseInt(t.clientY);let e=r.c({x:this.endX-this.startX,y:this.endY-this.startY});this.x=this.originalX+e.x,this.y=this.originalY+e.y,this.render(),this.emit('rectmove',this)}handleMouseUpOnDocument(){this._dragging&&(this._dragging=!1,this.originalX=null,this.originalY=null,this.startX=null,this.startY=null,this.endX=null,this.endY=null,this.save(),this.enableViewMode(),l.emit('rectmoveend',this)),document.removeEventListener('mousemove',this.handleMouseMoveOnDocument),document.removeEventListener('mouseup',this.handleMouseUpOnDocument),'rect'!==window.currentType&&r.b()}enableDragAction(){this.$element.find('.anno-rect, circle').off('mousedown',this.handleMouseDownOnRect).on('mousedown',this.handleMouseDownOnRect)}disableDragAction(){this.$element.find('.anno-rect, circle').off('mousedown',this.handleMouseDownOnRect)}enableViewMode(){super.enableViewMode(),this.readOnly||(this.$element.find('.anno-rect, .anno-knob').on('click',this.handleClickEvent),this.enableDragAction())}disableViewMode(){super.disableViewMode(),this.$element.find('.anno-rect, .anno-knob').off('click'),this.disableDragAction()}}t.a=s},,,,,,,function(e,t,n){'use strict';function o(){$('#annoLayer, #annoLayer2').remove()}function i(){if(!window.PDFView.pdfViewer.getPageView(0))return;const e='annoLayer',t='annoLayer2';if(0<$('#'+e).length)return;if(0<$('#'+t).length)return;let n=($('#viewer').width()-$('.page').width())/2;0>n&&(n=9);let o=$('#viewer').height(),i=$('.page').width(),a=$(`<svg id="${e}" class="${e}"/>`).css({position:'absolute',top:'0px',left:`${n}px`,width:`${i}px`,height:`${o}px`,visibility:'hidden',"z-index":2}),l=$(`<div id="${t}"/>`).addClass('annoLayer').css({position:'absolute',top:'0px',left:`${n}px`,width:`${i}px`,height:`${o}px`,visibility:'hidden',"z-index":2});$('#viewer').css({position:'relative'}).append(a).append(l),r()}function r(){const e=window.annotationContainer.getAllAnnotations();0===e.length||(e.forEach((e)=>{e.render(),e.enableViewMode()}),a.b('annotationrendered'))}Object.defineProperty(t,'__esModule',{value:!0});var a=n(2),l=n(54),s=n.n(l),d=n(72),u=n(83);n(70),window.globalEvent=new s.a,t['default']=d.a,window.annotationContainer=new u.a,d.a.UI.enableViewMode(),window.addEventListener('pagerendered',function(e){if(console.log('pagerendered:',e.detail.pageNumber),!!window.PDFView.pdfViewer.getPageView(0)){i();let e=window.PDFView.pdfViewer.getPageView(0).viewport.scale,t=`${9*e}px`,n=`${-9*e}px`,o=`${1*e}px`;$('.page').css({"border-top-width":t,"border-bottom-width":t,"margin-bottom":n,marginTop:o})}}),window.addEventListener('scalechange',()=>{console.log('scalechange'),o(),i()})},function(e,t,n){var o=n(71);'string'==typeof o&&(o=[[e.i,o,'']]);n(6)(o,{});o.locals&&(e.exports=o.locals),!1},function(e,t,n){t=e.exports=n(5)(),t.push([e.i,'@charset "utf-8";\n\n/*\n *  Search UI.\n */\n.pdfanno-search-result {\n    position: absolute;\n    background-color: rgba(0, 255, 0, 0.7)\n}\n.pdfanno-search-result--highlight {\n    background-color: rgba(255, 0, 0, 0.7)\n}\n\n/*\n * Text Layer.\n */\n.pdfanno-text-layer {\n    position: absolute;\n    text-align: center;\n}\n\n/**\n * Annotation Layer.\n */\n.annoLayer > * {\n  opacity: 0.5;\n}\n.annoLayer > *.\\--hover,\n.annoLayer > *.\\--selected {\n  opacity: 1;\n}\n\n/**\n    Annotation Knob for control.\n*/\n.anno-knob {\n    position: absolute;\n    background-color: blue;\n    border-radius: 50%;\n    transition: 0.2s;\n    transform-origin: center center;\n}\n.\\--hover .anno-knob,\n.\\--selected .anno-knob {\n  box-shadow: rgba(113,135,164,.2) 1px 1px 1px;\n  transform: scale(2);\n}\n.anno-knob.is-readonly {\n    border-radius: 0;\n    transform: rotate(45deg) scale(0.7);\n}\n.\\--hover .anno-knob.is-readonly,\n.\\--selected .anno-knob.is-readonly {\n  transform: rotate(45deg) scale(1.4);\n}\n\n/*\n * Span Annotation.\n */\n.anno-span {\n    position: absolute;\n    top: 0;\n    left: 0;\n    visibility: visible;\n}\n.anno-span__area {\n    position: absolute;\n    border: 1px dashed black;\n}\n.\\--hover .anno-span__area,\n.\\--selected .anno-span__area {\n  border: 2px dashed black !important;\n  box-sizing: border-box;\n}\n.anno-span__border {\n    position: absolute;\n    border-bottom-width: 1px;\n    border-bottom-style: solid;\n}\n\n/*TODO Relation\u3092\u63CF\u753B\u3057\u305F\u76F4\u5F8C\u306F\u3001\u4F4D\u7F6E\u304C\u5C11\u3057\u305A\u308C\u308B\u3002\u305D\u306E\u5F8C\u306B\u30D5\u30A9\u30FC\u30AB\u30B9\u304C\u5916\u308C\u308B\u3068\u6B63\u3057\u3044\u4F4D\u7F6E\u3078\u79FB\u52D5\u3059\u308B\u3002*/\n\n/**\n  Relation Annotation.\n*/\n.\\--hover .anno-relation,\n.\\--selected .anno-relation {\n  stroke-width: 2px;\n}\n.anno-relation-outline {\n  fill: none;\n  visibility: hidden;\n}\n.\\--selected .anno-relation-outline {\n  visibility: visible;\n  stroke: black;\n  stroke-width: 4px;\n  pointer-events: stroke;\n  stroke-dasharray: 5;\n}\n\n/**\n * Span Annotation.\n */\n.anno-span rect {\n    /* Enable the hover event on circles and text even if they are overwraped other spans. */\n    pointer-events: none;\n}\n\n/**\n  Rect Annotation.\n*/\n.anno-rect-base {\n    position: absolute;\n    top: 0;\n    left: 0;\n    visibility: visible;\n}\n.anno-rect {\n    position: absolute;\n}\n.\\--hover .anno-rect {\n  box-shadow: 0 0 0 1px #ccc inset;\n  stroke: #ccc;\n  stroke-width: 0.75px;\n}\n.\\--selected .anno-rect {\n  stroke: black;\n  stroke-width: 0.5px;\n  stroke-dasharray: 3;\n}\n\n/**\n Disable text layers.\n*/\nbody.disable-text-layer .textLayer {\n    display: none;\n}\n\n',''])},function(e,t,n){'use strict';var o=n(73),i=n(62),r=n(48),a=n(51);t.a={UI:o.a,RectAnnotation:i.a,SpanAnnotation:r.a,RelationAnnotation:a.a}},function(e,t,n){'use strict';var o=n(74),i=n(81),r=n(82);t.a={createSpan:o.a,getRectangles:o.b,createRelation:i.a,enableViewMode:r.a}},function(n,o,i){'use strict';function r(){return window.PDFView.pdfViewer.getPageView(0).viewport.scale}function a(){try{let e=window.getSelection();if(0===e.rangeCount)return{rects:null,selectedText:null,textRange:null};let t=e.getRangeAt(0),n=t.getClientRects();const o=l(e.anchorNode),i=s(e.anchorNode),r=s(e.focusNode);if(null===o||o===void 0||null===i||i===void 0||null===r||r===void 0)return{rects:null,selectedText:null,textRange:null};const{text:a,textRange:u}=window.getText(o,i,r);if(e.anchorNode&&'DIV'===e.anchorNode.tagName)return{rects:null,selectedText:null,textRange:null};if(0<n.length&&0<n[0].width&&0<n[0].height)return{rects:d(n),selectedText:a,textRange:u}}catch(t){console.log('ERROR:',t)}return{rects:null,selectedText:null,textRange:null}}function l(e){if(e.parentNode.hasAttribute('data-page'))return parseInt(e.parentNode.getAttribute('data-page'),10);return e.hasAttribute&&e.hasAttribute('data-page')?parseInt(e.getAttribute('data-page'),10):null}function s(e){if(e.parentNode.hasAttribute('data-index'))return parseInt(e.parentNode.getAttribute('data-index'),10);return e.hasAttribute&&e.hasAttribute('data-index')?parseInt(e.getAttribute('data-index'),10):null}function d(t){var n=Math.max;t=t.filter((e)=>e),t=t.map((e)=>(e.top=e.top||e.y,e.left=e.left||e.x,e.right=e.right||e.x+e.w,e.bottom=e.bottom||e.y+e.h,e)),t=u(t);const o=5*r();let a=p(t[0]),l=[a];for(let r=1;r<t.length;r++)c(t[r].top,a.top,o)?(a.top=e(a.top,t[r].top),a.left=e(a.left,t[r].left),a.right=n(a.right,t[r].right),a.bottom=n(a.bottom,t[r].bottom),a.x=a.left,a.y=a.top,a.width=a.right-a.left,a.height=a.bottom-a.top):(a=p(t[r]),l.push(a));return l}function u(e){const n=1.5*r();let o=[e[0]];for(let r=1;r<e.length;r++)t(e[r].left-e[r-1].left)<n||o.push(e[r]);return o}function p(e){return{top:e.top,left:e.left,right:e.right,bottom:e.bottom,x:e.x,y:e.y,width:e.width,height:e.height}}function c(e,t,n){return t-n<=e&&e<=t+n}function h({text:e='',rects:t=[],textRange:n=[],selectedText:o='',zIndex:i=10,color:r='#ffff00',page:a=1,save:l=!0,focusToLabel:s=!0,knob:d=!0}){if(console.log('saveSpan:',...arguments),!!t){let u=9,p=window.PDFView.pdfViewer.getPageView(0).viewport.viewBox[3],c=x.a.newInstance({rectangles:t,selectedText:o,text:e,textRange:n,zIndex:i,color:r,page:a,knob:d});return l&&c.save(),c.render(),c.select(),s&&f.a({uuid:c.uuid,autoFocus:!0,text:e}),c}}function y(){if(!C||!w||!k)return null;else{let e=findTexts(C,w,k);return d(e)}}function v({text:e=null,zIndex:t=10,color:n=null}){if(!C||!w||!k)return null;else{let o=findTexts(C,w,k);if(0===o.length)return null;let i=o.map((e)=>e?e.char:' ').join('');const r=d(o),a=h({rects:r,page:C,text:e,zIndex:t,color:n,textRange:[w,k],selectedText:i});return E&&E.destroy(),w=null,k=null,C=null,E=null,a}}o.b=y,o.a=v;var g=i(55),x=i(48),f=i(61);let b,m;(function(){setInterval(()=>{b=m,m=a()},250)})(),window.addEventListener('DOMContentLoaded',()=>{function t(t){const e=t.currentTarget,n=e.parentNode,o=parseInt(n.getAttribute('data-page-number'));C=o;const{top:i,left:r}=e.getBoundingClientRect(),a=t.clientX-r,l=t.clientY-i,s=window.findText(o,g.c({x:a,y:l}));console.log('item:',s),s&&(w&&k?k=s.position:(w=s.position,k=s.position))}function n(n){t(n),E&&(E.destroy(),E=null);let e=findTexts(C,w,k);if(e=e.filter((e)=>e),0<e.length){const t=d(e);E=h({rects:t,page:C,save:!1,focusToLabel:!1,color:'#0f0',knob:!1}),E.disable()}}let o=[];const e=$('#viewer');e.on('mousedown','.canvasWrapper',(t)=>{i||(A=!0,o=[],C=null,w=null,k=null,E&&(E.destroy(),E=null),n(t))}),e.on('mousemove','.canvasWrapper',(t)=>{A&&n(t)}),e.on('mouseup','.canvasWrapper',(t)=>{A&&n(t),A=!1});let i=!1;window.addEventListener('annotationHoverIn',()=>{i=!0}),window.addEventListener('annotationHoverOut',()=>{i=!1})});let A=!1,w=null,k=null,C=null,E=null},function(e,t,n){'use strict';function o(e,t){return e.style.transform=`scale(${t.scale})`,e}t.a=function(e,t,n){n||(n=window.PDFView.pdfViewer.getPageView(0).viewport);let s;switch(t.type){case'rect':s=i.a(t,e);break;case'span':s=r.a(t,e);break;case'textbox':s=a.a(t,e);break;case'relation':s=l.a(t,e);}if(s){let i=o(s,n);'textbox'===t.type?e.appendChild(i):e.append(i)}return s};var i=n(76),r=n(77),a=n(79),l=n(80)},function(e,t,n){'use strict';t.a=function(e){let t=e.color||'#FF0';const n=$('<div class="anno-rect-base"/>');return n.append($('<div class="anno-rect"/>').css({top:`${e.y}px`,left:`${e.x}px`,width:`${e.width}px`,height:`${e.height}px`,border:`1px solid ${t}`,backgroundColor:e.readOnly?'none':i.a(t,.3)})),n.append(o.b(e)),n[0]};var o=n(50),i=n(56)},function(e,t,n){'use strict';function o(e,t,n){if(n)return $('<div class="anno-span__border"/>').css({top:e.y+'px',left:e.x+'px',width:e.width+'px',height:e.height+'px',borderColor:t});else{const n=a.a(t,.4);return $('<div class="anno-span__area"/>').css({top:e.y+'px',left:e.x+'px',width:e.width+'px',height:e.height+'px',backgroundColor:n})}}t.a=function(e){const t=e.readOnly,n=e.color||'#FF0',a=$('<div class="anno-span"/>').css('zIndex',e.zIndex||10);let r=9,l=window.PDFView.pdfViewer.getPageView(0).viewport.viewBox[3],s=r+(r+l+1)*(e.page-1);const d=e.rectangles.map((e)=>({x:e.x||e.left,y:(e.y||e.top)+s,width:e.width||e.right-e.left,height:e.height||e.bottom-e.top})).filter((e)=>0<e.width&&0<e.height&&-1<e.x&&-1<e.y);return d.forEach((e)=>{a.append(o(e,n,t))}),e.knob&&a.append(i.b({x:d[0].x,y:d[0].y,readOnly:t})),a[0]};var i=n(50),a=n(56),r=n(57);console.log('ANNO_VERSION:',r.a)},function(e){e.exports={name:'pdfanno',version:'0.4.1-dev',description:'',main:'index.js',scripts:{_prepare:'gulp prepare',start:'concurrently --kill-others "npm run server:dev" "npm run front:dev"',"front:sw":'gulp build-sw',"front:sw:watch":'gulp watch-sw',"front:dev":'concurrently --kill-others "npm run _prepare && npm run front:sw && webpack-dev-server --inline" "npm run front:sw:watch"',"front:publish:latest":'npm run _prepare && cross-env BUILD_TARGET=latest npm run front:sw && cross-env NODE_ENV=production SERVER_PATH=latest webpack && gulp publish_latest',"front:publish:stable":'npm run _prepare && cross-env BUILD_TARGET=stable  npm run front:sw && cross-env NODE_ENV=production SERVER_PATH=0.3.1  webpack && gulp publish_stable',"server:latest":'cross-env NODE_ENV=production NODE_PORT=1001 node server/server.js',"server:stable":'cross-env NODE_ENV=production NODE_PORT=1000 node server/server.js',"server:dev":'cross-env NODE_PORT=3000 ./node_modules/.bin/node-dev server/server.js'},repository:{type:'git',url:'git+https://github.com/paperai/pdfanno'},author:'hshindo, yoheiMune',license:'MIT',bugs:{url:'https://github.com/paperai/pdfanno/issues'},homepage:'https://github.com/paperai/pdfanno#readme',pdfextract:{version:'0.2.3',url:'https://github.com/paperai/pdfextract/releases/download/v0.2.3/pdfextract-0.2.3.jar'},devDependencies:{"babel-cli":'^6.26.0',"babel-core":'^6.26.0',"babel-eslint":'^7.2.3',"babel-helpers":'^6.24.1',"babel-loader":'6.2.4',"babel-messages":'^6.23.0',"babel-minify-webpack-plugin":'^0.3.0',"babel-plugin-add-module-exports":'^0.2.1',"babel-preset-es2015":'^6.24.1',"babel-preset-stage-1":'^6.24.1',concurrently:'^3.5.1',copy:'^0.3.0',cpr:'^2.2.0',"cross-env":'^5.0.5',"css-loader":'^0.25.0',"deep-assign":'^2.0.0',eslint:'^3.19.0',"eslint-config-standard":'^6.2.1',"eslint-friendly-formatter":'^2.0.7',"eslint-loader":'^1.7.1',"eslint-plugin-html":'^2.0.0',"eslint-plugin-promise":'^3.5.0',"eslint-plugin-standard":'^2.3.1',"file-loader":'^0.9.0',"fs-extra":'^1.0.0',"fuse.js":'^3.1.0',gulp:'^3.9.1',"gulp-clean-css":'^3.9.3',"gulp-cli":'^1.4.0',"gulp-replace":'^0.6.1',"gulp-sourcemaps":'^2.6.4',"gulp-uglify-es":'^1.0.1',"gulp-util":'^3.0.8',"node-dev":'^3.1.3',"run-sequence":'^2.2.1',"style-loader":'^0.13.2',"vinyl-source-stream":'^1.1.0',webpack:'3.0.0',"webpack-dev-server":'^1.16.5'},dependencies:{"anno-ui":'github:paperai/anno-ui#master',axios:'^0.15.2',"body-parser":'^1.17.2',express:'^4.15.4',"gulp-htmlmin":'^4.0.0',"json-loader":'^0.5.7',mkdirp:'^0.5.1',"mkdirp-promise":'^5.0.1',multer:'^1.3.0',request:'^2.81.0',"request-promise":'^4.2.2',requirejs:'^2.3.5',"socket.io":'^2.0.4',toml:'github:yoheiMune/toml-node',urijs:'^1.19.0'}}},function(e,t,n){'use strict';function o(e,t){t.appendChild(e);let n=e.getBoundingClientRect();return e.parentNode.removeChild(e),n}t.a=function(e,t){let n=document.createElementNS('http://www.w3.org/2000/svg','text');i.a(n,{x:e.x,y:e.y+parseInt(r,10),fill:e.color||'#F00',fontSize:r}),n.innerHTML=e.content||e.text;let a=document.createElementNS('http://www.w3.org/2000/svg','rect'),l=o(n,t);i.a(a,{x:e.x-1,y:e.y,width:l.width,height:l.height,fill:'#FFFFFF',class:'anno-text'});let s=document.createElementNS('http://www.w3.org/2000/svg','g');return s.classList.add('anno-text-group'),s.setAttribute('read-only',!0===e.readOnly),s.setAttribute('data-parent-id',e.parentId),s.style.visibility='visible',s.appendChild(a),s.appendChild(n),s};var i=n(58);const r=9.5},function(r,a,l){'use strict';function s(e,t,n,o){const i=50;let r=$('<svg class=""/>').css({position:'absolute',top:`${e-i}px`,left:`${t-i}px`,width:`${n+2*i}px`,height:`${o+2*i}px`,visibility:'hidden',"z-index":2}).attr({x:0,y:0});return[r,i]}a.a=function(r){r.color=r.color||'#F00';let a=i((r.y1-r.y2)/(r.x1-r.x2)),l=r.x1<r.x2?1:-1;r.x1+=u.a*o(a)*l,r.x2-=u.a*o(a)*l,r.y1+=u.a*n(a)*l,r.y2-=u.a*n(a)*l;let c=e(r.y1,r.y2),h=e(r.x1,r.x2),y=t(r.x1-r.x2),v=t(r.y1-r.y2);const[g,x]=s(c,h,y,v);r.x1=r.x1-h+x,r.x2=r.x2-h+x,r.y1=r.y1-c+x,r.y2=r.y2-c+x;let f=document.createElementNS('http://www.w3.org/2000/svg','g');d.a(f,{fill:r.color,stroke:r.color}),f.style.visibility='visible',f.setAttribute('read-only',!0===r.readOnly),g[0].appendChild(f);const b='relationhead'+r.color.replace('#','');if(!document.querySelector('#'+b)){let e=document.createElementNS('http://www.w3.org/2000/svg','marker');d.a(e,{viewBox:'0 0 10 10',markerWidth:2,markerHeight:3,fill:r.color,id:b,orient:'auto-start-reverse'}),e.setAttribute('refX',5),e.setAttribute('refY',5),f.appendChild(e);let t=document.createElementNS('http://www.w3.org/2000/svg','polygon');d.a(t,{points:'0,0 0,10 10,5'}),e.appendChild(t)}let m=p.a(r.x1,r.y1,r.x2,r.y2),A=document.createElementNS('http://www.w3.org/2000/svg','path');d.a(A,{d:`M ${r.x1} ${r.y1} Q ${m.x} ${m.y} ${r.x2} ${r.y2}`,class:'anno-relation-outline'}),f.appendChild(A);let w=document.createElementNS('http://www.w3.org/2000/svg','path');d.a(w,{d:`M ${r.x1} ${r.y1} Q ${m.x} ${m.y} ${r.x2} ${r.y2}`,stroke:r.color,strokeWidth:1,fill:'none',class:'anno-relation'}),('one-way'===r.direction||'two-way'===r.direction)&&w.setAttribute('marker-end',`url(#${b})`),'two-way'===r.direction&&w.setAttribute('marker-start',`url(#${b})`),f.appendChild(w);const k=$('<div/>').css({position:'absolute',top:0,left:0,visibility:'visible'}).addClass('anno-relation');return k.append(g),k[0]};var d=l(58),u=l(50),p=l(59)},function(e,t,n){'use strict';t.a=function({type:e,anno1:t,anno2:n,text:r,color:a}){3===arguments.length&&(e=arguments[0],t=arguments[1],n=arguments[2]);let l=new i.a;return l.direction=e,l.rel1Annotation=t,l.rel2Annotation=n,l.text=r,l.color=a,l.save(),l.render(),window.annotationContainer.getSelectedAnnotations().forEach((e)=>e.deselect()),l.select(),o.a({uuid:l.uuid,autoFocus:!0,text:r}),l};var o=n(61),i=n(51)},function(e,t){'use strict';function n(t){return'input'===t.target.tagName.toLowerCase()?void 0:46===t.keyCode||8===t.keyCode?(t.preventDefault(),'keyup'===t.type&&i(),!1):void 0}function o(){window.annotationContainer.getSelectedAnnotations().forEach((e)=>e.deselect());var e=document.createEvent('CustomEvent');e.initCustomEvent('annotationDeselected',!0,!0,this),window.dispatchEvent(e)}function i(){window.globalEvent.emit('deleteSelectedAnnotation')}t.a=function(){console.log('view:enableViewMode'),document.removeEventListener('keyup',n),document.removeEventListener('keydown',n),document.addEventListener('keyup',n),document.addEventListener('keydown',n),$(document).off('click',o).on('click','.page',o)}},function(e,t,n){'use strict';var o=n(4),i=n(57),r=n(84),a=n(60),l=n(1),s=n(48),u=n(62),p=n(51);t.a=class{constructor(){this.set=new Set}add(e){this.set.add(e),a.a('annotationUpdated')}remove(e){this.set.delete(e),a.a('annotationUpdated')}destroy(){console.log('AnnotationContainer#destroy'),this.set.forEach((e)=>e.destroy()),this.set=new Set}getAllAnnotations(){let e=[];return this.set.forEach((t)=>e.push(t)),e}getSelectedAnnotations(){return this.getAllAnnotations().filter((e)=>e.selected)}findById(e){e+='';let t=null;return this.set.forEach((n)=>{n.uuid===e&&(t=n)}),t}changeColor({text:e,color:t,uuid:n,annoType:o}){if(console.log('changeColor: ',e,t,n),n){const e=this.findById(n);e&&(e.color=t,e.render(),e.enableViewMode())}else this.getAllAnnotations().filter((t)=>t.text===e).filter((e)=>'span'===o?e.type===o:('one-way'===o||'two-way'===o||'link'===o)&&'relation'===e.type&&e.direction===o).forEach((e)=>{e.color=t,e.render(),e.enableViewMode()})}setColor(e){console.log('setColor:',e),Object.keys(e).forEach((t)=>{'default'===t||Object.keys(e[t]).forEach((n)=>{const o=e[t][n];this.changeColor({text:n,color:o,annoType:t})})})}exportData(){return new Promise((e)=>{let t={version:i.a};const n=this.getAllAnnotations().filter((e)=>!e.readOnly);n.sort((e,t)=>e.createdAt-t.createdAt);let o=0;n.forEach((e)=>{if(o++,'span'===e.type){let n=e.page,i=e.rectangles.map((e)=>[e.x,e.y,e.width,e.height]),r=(e.selectedText||'').replace(/\r\n/g,' ').replace(/\r/g,' ').replace(/\n/g,' ').replace(/"/g,'').replace(/\\/g,'');t[o]={type:e.type,page:n,position:i,label:e.text||'',text:r,textrange:e.textRange},e.exportId=o}else if('relation'===e.type)t[o]={type:'relation',dir:e.direction,ids:[e.rel1Annotation.exportId,e.rel2Annotation.exportId],label:e.text||''};else if('rect'===e.type){let{pageNumber:n,y:i}=l.b(e.y);t[o]={type:'rect',page:n,position:[e.x,i,e.width,e.height],label:e.text||''},e.exportId=o}}),e(r.b(t))})}importAnnotations(e,t){function n(e,t,n){let o=i.default;return i[t]&&i[t][n]&&(o=i[t][n]),o}const l=!t,i=e.colorMap;return new Promise((t)=>{this.getAllAnnotations().filter((e)=>e.readOnly===l).forEach((e)=>e.destroy()),e.annotations.forEach((e,t)=>{let i=r.a(e);if(i)for(const e in i){let r=i[e];if('object'==typeof r)if(r.uuid=o.a(),r.readOnly=l,'span'===r.type){let e=s.a.newInstanceFromTomlObject(r);e.color=n(t,e.type,e.text),e.save(),e.render(),e.enableViewMode()}else if('rect'===r.type){let e=u.a.newInstanceFromTomlObject(r);e.color=n(t,e.type,e.text),e.save(),e.render(),e.enableViewMode()}else if('relation'===r.type){r.rel1=i[r.ids[0]].uuid,r.rel2=i[r.ids[1]].uuid;let e=p.a.newInstanceFromTomlObject(r);e.color=n(t,e.direction,e.text),e.save(),e.render(),e.enableViewMode()}else console.log('Unknown: ',e,r)}}),t(!0)})}}},function(e,t,n){'use strict';function o(e,t=!0){let n=[];if('version'in e&&(n.push(`version = "${e.version}"`),n.push(''),delete e.version),'position'in e){let t=e.position;t=t.map((e)=>'number'==typeof e?e+'':e.map((e)=>e+'')),e.position=t}return Object.keys(e).forEach((r)=>{let a=e[r];'string'==typeof a?(n.push(`${r} = "${a}"`),t&&n.push('')):'number'==typeof a?(n.push(`${r} = ${a}`),t&&n.push('')):i(a)?(n.push(`${r} = ${JSON.stringify(a)}`),t&&n.push('')):'object'==typeof a&&(n.push(`[${r}]`),n.push(o(a,!1)),t&&n.push(''))}),n.join('\n')}function i(e){return e&&'length'in e}t.b=o,t.a=function(t){try{return a.a.parse(t)}catch(n){return console.log('ERROR:',n),console.log('TOML:\n',t),null}};var r=n(12),a=n.n(r)}])});
//# sourceMappingURL=pdfanno.core.bundle.js.map