{"version":3,"sources":["webpack:///webpack/universalModuleDefinition?5ca6***","webpack:///webpack/bootstrap a66cadafbfdf66b9a6e1?2f57***","webpack:///./src/l10n.js"],"names":[],"mappings":"AAAA,cACA,2BACA,uCACA,sCACA,WACA,MACA,6CAEA,kBACA,GAAC,mBACD,kBCTA,cAMA,IACA,iBAGA,mBACA,CACA,IACA,aAIA,mCAGA,aAGA,OACA,OAIA,OAzBA,YA4BA,MAGA,uBACA,GACA,kCACA,CACA,gBACA,cAGA,OAGA,iBACA,YACA,qBAA2B,UAA0B,UACrD,YAAiC,CAAe,QAChD,EAEA,aADA,QAIA,mBAAsD,wCAA+D,SAGrH,MAGA,6BC9BA,aAEA,8BACA,aA+BA,2BACA,gCAEA,aACA,uBAEA,oEACA,IAEA,cACA,gDACA,EAEA,cACA,IACA,SAEA,wBACA,iCACA,oBACA,GACA,QACA,QACA,QAAO,SACP,cACA,oCAEA,OAAY,MACZ,OAEA,cACA,qBACA,qBACA,qBACA,aACA,gBAEA,kBACA,iBACA,iBACA,gBACA,cAEA,WACA,uBACA,aACA,qCAEA,4DACA,CACA,iCACA,iBAEA,cAGA,IACA,IACA,YAIA,eACA,QACA,KAAK,SACL,CACA,GACA,CA0BA,oBACA,cAIA,OAEA,2CACA,qBACA,qBACA,qBACA,qBACA,qBACA,cAA8B,OAC9B,aAA8B,OAC9B,oBACA,oBACA,KAKA,gBACA,kBAWA,aASA,QACA,OACA,OAGA,WAFA,aAKA,cAIA,cACA,QACA,UAIA,QACA,gBACA,gBACA,MACA,QAAe,KACf,MAEA,SAEA,OADA,UAIA,kBAFA,KAKA,SACA,YACA,0BAEA,KACA,CACA,6BA/CA,aACA,qBACA,GACA,OAEA,GA2CA,GAGA,gBACA,gBACA,CACA,SAAS,EACT,KAGA,OAnEA,KACA,cACA,gBACA,qBACA,mCAGA,0CA6DA,CACA,IACA,EAGA,gCA/FA,oBAgGA,CAGA,oBAGA,gBACA,yBACA,KACA,mBACA,kBAEA,KACA,IAEA,KACA,YAEA,YACA,IAIA,IAEA,GACA,EACA,IAGA,gBAIA,cAsDA,SAGA,4BACA,mBACA,gBAEA,kCACA,0BAEA,GACA,GACA,EACA,CAEA,SAlEA,+BAEA,EACA,IAIA,UACA,QACA,gBAEA,OACA,sCACA,gBACA,wDACA,cACA,wBACA,6BACA,eACA,oBACA,KACA,WACA,KAAa,KACb,aAGA,WACA,CACA,GACA,kBAGA,sCAGA,MAFA,aACA,WAIA,OACA,OACA,cACA,CACA,IACA,OACA,IACA,OAEA,WAGA,cAgBmB,EAAe,IAClC,YACA,QAEA,SAGA,aACA,GACA,KACA,KAGA,EAmBA,cACA,gBA+KA,QACA,gBACA,kBACA,cACA,IAIA,OACA,aACA,OACA,OACA,eACA,kBACA,IACA,MACA,MACA,kBACA,IACA,OACA,KACA,MACA,KACA,MACA,OACA,eACA,eACA,QACA,OACA,KACA,MACA,KACA,MACA,OACA,eACA,OACA,MACA,MACA,OACA,eACA,cACA,GACA,MACA,OACA,eACA,kBACA,KACA,MACA,OACA,eACA,OACA,OACA,gBACA,UACA,MACA,OACA,eACA,OACA,MACA,MACA,KACA,MACA,OACA,eACA,cACA,GACA,YACA,IACA,OACA,KACA,MACA,KACA,MACA,OACA,eACA,+BACA,IACA,MACA,KACA,MACA,OACA,gBACA,iCACA,IACA,0BACA,IAEA,QADA,KAEA,gBACA,iCACA,IACA,MACA,kBACA,eACA,IACA,gBACA,UACA,MACA,OACA,gBACA,cACA,GACA,MACA,KACA,MACA,OACA,gBACA,iCACA,IACA,qBACA,aACA,eACA,IACA,OACA,KACA,MACA,OACA,gBACA,kBACA,GACA,MACA,SACA,MACA,SACA,MACA,OACA,gBACA,yBACA,IACA,iBACA,IACA,OACA,KACA,MACA,OACA,gBACA,iBACA,MACA,MACA,OACA,gBACA,OACA,MACA,MACA,MACA,OACA,KACA,OACA,KACA,MACA,KACA,MACA,OACA,gBACA,OACA,OACA,wBACA,KACA,MACA,OACA,gBACA,cACA,IACA,YACA,GACA,MACA,OACA,gBACA,+BACA,aACA,gBACA,gBAEA,KACA,gBACA,MACA,+BACA,6BAEA,KAEA,QADA,MAFA,KAIA,gBACA,OACA,OACA,OACA,KACA,MACA,OACA,gBACA,yBACA,IACA,MACA,OACA,gBACA,qBACA,QACA,MACA,OACA,gBACA,0BACA,IACA,aACA,KACA,aACA,KACA,MACA,OAIA,KAjYA,IACA,KACA,KACA,KACA,MACA,KACA,KACA,OACA,MACA,KACA,KACA,KACA,KACA,KACA,KACA,OACA,KACA,MACA,MACA,MACA,KACA,MACA,MACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,MACA,KACA,KACA,MACA,KACA,KACA,KACA,MACA,MACA,KACA,MACA,KACA,MACA,MACA,KACA,KACA,KACA,MACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,MACA,KACA,KACA,MACA,MACA,MACA,MACA,MACA,KACA,KACA,KACA,KACA,KACA,MACA,MACA,MACA,KACA,MACA,MACA,KACA,KACA,KACA,KACA,MACA,MACA,KACA,KACA,MACA,KACA,KACA,KACA,KACA,KACA,MACA,MACA,MACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,MACA,KACA,MACA,KACA,KACA,KACA,MACA,KACA,MACA,KACA,KACA,KACA,MACA,KACA,OACA,MACA,MACA,KACA,MACA,MACA,KACA,KACA,OACA,MACA,MACA,OACA,MACA,MACA,MACA,MACA,KACA,KACA,KACA,KACA,MACA,MACA,KACA,KACA,KACA,MACA,KACA,KACA,MACA,KACA,KACA,MACA,KACA,KACA,KACA,KACA,KACA,KACA,MACA,MACA,MACA,KACA,KACA,MACA,KACA,MACA,KACA,KACA,MACA,KACA,KACA,KAIA,oBAqNA,WACA,QAIA,iDAHA,eAAyB,OAAgB,OAEzC,EAIA,kBAsCA,OACA,WACA,uBACA,kBACA,SAEA,MACA,GAOA,OACA,kBACA,OACA,OACA,aACA,SACA,MACA,CACA,QAGA,oBACA,OACA,+CACA,kBACA,OAIA,YAGA,OAFA,OACA,SAEA,SACK,KACL,WAIA,aACA,OACA,OACA,UACA,CACA,QAGA,kBACA,OACA,uDACA,WACA,OAEA,KACA,OAEA,kBAA8B,gBAAa,aAE3C,oBACA,EAGA,cACA,OACA,UAIA,mBACA,SACA,GAKA,kCAJA,0BAKA,IACA,cACO,SAGP,aACA,WACA,aAA4C,OAAO,IACnD,sCAEA,8BAEA,mBACA,KAMA,aACA,wBACA,yBACA,WACA,CACA,OACA,KAEA,QACA,aAEA,KAGA,cACA,MACA,2BAEA,UACA,iDAEA,4BACA,IAAmB,iBAA+B,OAClD,wBAEA,EACA,QAGA,cACA,QAGA,0BACA,SACA,SAAmB,EAAkB,IACrC,MAIA,MACA,IAEA,OAt6BA,KACA,KACA,gBACA,KACA,KAeA,UAUA,sCAstBA,OACA,iBACA,SAGA,YACA,KAGA,WACA,8BAEA,kCAGA,IAaA,gBAZA,mBACK,qBACL,kBACK,oBACL,kBACK,YACL,aACK,UACL,sBAGA,gBASA,EAiJA,oBACA,qBACA,KACA,IACA,mBACA,iBAEA,SAEA,SACA,GAEA,cACA,mBACA,OAEA,KAAgB,OAChB,IAGA,oBAAyB,CAAkB,QAC3C,oBAAyB,CAAkB,QAG3C,wBAA6B,CAAkB,QAC/C,2BACA,eAEA,IACA,IACA,GACA,EAGA,yBAGA,sBAEA,kCADA,uBAEA,KAGA,EAGA,oCAA+B,CAAoB,QACnD,mBAGO,oBACP,wCACA,CACA,GACO,KACP,6DACA,uBACA,eACA,GAEA,GAEA,EAAC","file":"./dist/l10n.bundle.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"PDFAnnoCore\"] = factory();\n\telse\n\t\troot[\"PDFAnnoCore\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 94);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap a66cadafbfdf66b9a6e1","/*eslint-disable */\r\n/**\r\n * Copyright (c) 2011-2013 Fabien Cazenave, Mozilla.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to\r\n * deal in the Software without restriction, including without limitation the\r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is\r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n */\r\n/*\r\n  Additional modifications for PDF.js project:\r\n    - Disables language initialization on page loading;\r\n    - Removes consoleWarn and consoleLog and use console.log/warn directly.\r\n    - Removes window._ assignment.\r\n    - Remove compatibility code for OldIE.\r\n*/\r\n\r\n/*jshint browser: true, devel: true, es5: true, globalstrict: true */\r\n'use strict';\r\n\r\ndocument.webL10n = (function(window, document, undefined) {\r\n  var gL10nData = {};\r\n  var gTextData = '';\r\n  var gTextProp = 'textContent';\r\n  var gLanguage = '';\r\n  var gMacros = {};\r\n  var gReadyState = 'loading';\r\n\r\n\r\n  /**\r\n   * Synchronously loading l10n resources significantly minimizes flickering\r\n   * from displaying the app with non-localized strings and then updating the\r\n   * strings. Although this will block all script execution on this page, we\r\n   * expect that the l10n resources are available locally on flash-storage.\r\n   *\r\n   * As synchronous XHR is generally considered as a bad idea, we're still\r\n   * loading l10n resources asynchronously -- but we keep this in a setting,\r\n   * just in case... and applications using this library should hide their\r\n   * content until the `localized' event happens.\r\n   */\r\n\r\n  var gAsyncResourceLoading = true; // read-only\r\n\r\n\r\n  /**\r\n   * DOM helpers for the so-called \"HTML API\".\r\n   *\r\n   * These functions are written for modern browsers. For old versions of IE,\r\n   * they're overridden in the 'startup' section at the end of this file.\r\n   */\r\n\r\n  function getL10nResourceLinks() {\r\n    return document.querySelectorAll('link[type=\"application/l10n\"]');\r\n  }\r\n\r\n  function getL10nDictionary() {\r\n    var script = document.querySelector('script[type=\"application/l10n\"]');\r\n    // TODO: support multiple and external JSON dictionaries\r\n    return script ? JSON.parse(script.innerHTML) : null;\r\n  }\r\n\r\n  function getTranslatableChildren(element) {\r\n    return element ? element.querySelectorAll('*[data-l10n-id]') : [];\r\n  }\r\n\r\n  function getL10nAttributes(element) {\r\n    if (!element)\r\n      return {};\r\n\r\n    var l10nId = element.getAttribute('data-l10n-id');\r\n    var l10nArgs = element.getAttribute('data-l10n-args');\r\n    var args = {};\r\n    if (l10nArgs) {\r\n      try {\r\n        args = JSON.parse(l10nArgs);\r\n      } catch (e) {\r\n        console.warn('could not parse arguments for #' + l10nId);\r\n      }\r\n    }\r\n    return { id: l10nId, args: args };\r\n  }\r\n\r\n  function fireL10nReadyEvent(lang) {\r\n    var evtObject = document.createEvent('Event');\r\n    evtObject.initEvent('localized', true, false);\r\n    evtObject.language = lang;\r\n    document.dispatchEvent(evtObject);\r\n  }\r\n\r\n  function xhrLoadText(url, onSuccess, onFailure) {\r\n    onSuccess = onSuccess || function _onSuccess(data) {};\r\n    onFailure = onFailure || function _onFailure() {\r\n      console.warn(url + ' not found.');\r\n    };\r\n\r\n    var xhr = new XMLHttpRequest();\r\n    xhr.open('GET', url, gAsyncResourceLoading);\r\n    if (xhr.overrideMimeType) {\r\n      xhr.overrideMimeType('text/plain; charset=utf-8');\r\n    }\r\n    xhr.onreadystatechange = function() {\r\n      if (xhr.readyState == 4) {\r\n        if (xhr.status == 200 || xhr.status === 0) {\r\n          onSuccess(xhr.responseText);\r\n        } else {\r\n          onFailure();\r\n        }\r\n      }\r\n    };\r\n    xhr.onerror = onFailure;\r\n    xhr.ontimeout = onFailure;\r\n\r\n    // in Firefox OS with the app:// protocol, trying to XHR a non-existing\r\n    // URL will raise an exception here -- hence this ugly try...catch.\r\n    try {\r\n      xhr.send(null);\r\n    } catch (e) {\r\n      onFailure();\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * l10n resource parser:\r\n   *  - reads (async XHR) the l10n resource matching `lang';\r\n   *  - imports linked resources (synchronously) when specified;\r\n   *  - parses the text data (fills `gL10nData' and `gTextData');\r\n   *  - triggers success/failure callbacks when done.\r\n   *\r\n   * @param {string} href\r\n   *    URL of the l10n resource to parse.\r\n   *\r\n   * @param {string} lang\r\n   *    locale (language) to parse. Must be a lowercase string.\r\n   *\r\n   * @param {Function} successCallback\r\n   *    triggered when the l10n resource has been successully parsed.\r\n   *\r\n   * @param {Function} failureCallback\r\n   *    triggered when the an error has occured.\r\n   *\r\n   * @return {void}\r\n   *    uses the following global variables: gL10nData, gTextData, gTextProp.\r\n   */\r\n\r\n  function parseResource(href, lang, successCallback, failureCallback) {\r\n    var baseURL = href.replace(/[^\\/]*$/, '') || './';\r\n\r\n    // handle escaped characters (backslashes) in a string\r\n    function evalString(text) {\r\n      if (text.lastIndexOf('\\\\') < 0)\r\n        return text;\r\n      return text.replace(/\\\\\\\\/g, '\\\\')\r\n                 .replace(/\\\\n/g, '\\n')\r\n                 .replace(/\\\\r/g, '\\r')\r\n                 .replace(/\\\\t/g, '\\t')\r\n                 .replace(/\\\\b/g, '\\b')\r\n                 .replace(/\\\\f/g, '\\f')\r\n                 .replace(/\\\\{/g, '{')\r\n                 .replace(/\\\\}/g, '}')\r\n                 .replace(/\\\\\"/g, '\"')\r\n                 .replace(/\\\\'/g, \"'\");\r\n    }\r\n\r\n    // parse *.properties text data into an l10n dictionary\r\n    // If gAsyncResourceLoading is false, then the callback will be called\r\n    // synchronously. Otherwise it is called asynchronously.\r\n    function parseProperties(text, parsedPropertiesCallback) {\r\n      var dictionary = {};\r\n\r\n      // token expressions\r\n      var reBlank = /^\\s*|\\s*$/;\r\n      var reComment = /^\\s*#|^\\s*$/;\r\n      var reSection = /^\\s*\\[(.*)\\]\\s*$/;\r\n      var reImport = /^\\s*@import\\s+url\\((.*)\\)\\s*$/i;\r\n      var reSplit = /^([^=\\s]*)\\s*=\\s*(.+)$/; // TODO: escape EOLs with '\\'\r\n\r\n      // parse the *.properties file into an associative array\r\n      function parseRawLines(rawText, extendedSyntax, parsedRawLinesCallback) {\r\n        var entries = rawText.replace(reBlank, '').split(/[\\r\\n]+/);\r\n        var currentLang = '*';\r\n        var genericLang = lang.split('-', 1)[0];\r\n        var skipLang = false;\r\n        var match = '';\r\n\r\n        function nextEntry() {\r\n          // Use infinite loop instead of recursion to avoid reaching the\r\n          // maximum recursion limit for content with many lines.\r\n          while (true) {\r\n            if (!entries.length) {\r\n              parsedRawLinesCallback();\r\n              return;\r\n            }\r\n            var line = entries.shift();\r\n\r\n            // comment or blank line?\r\n            if (reComment.test(line))\r\n              continue;\r\n\r\n            // the extended syntax supports [lang] sections and @import rules\r\n            if (extendedSyntax) {\r\n              match = reSection.exec(line);\r\n              if (match) { // section start?\r\n                // RFC 4646, section 4.4, \"All comparisons MUST be performed\r\n                // in a case-insensitive manner.\"\r\n\r\n                currentLang = match[1].toLowerCase();\r\n                skipLang = (currentLang !== '*') &&\r\n                    (currentLang !== lang) && (currentLang !== genericLang);\r\n                continue;\r\n              } else if (skipLang) {\r\n                continue;\r\n              }\r\n              match = reImport.exec(line);\r\n              if (match) { // @import rule?\r\n                loadImport(baseURL + match[1], nextEntry);\r\n                return;\r\n              }\r\n            }\r\n\r\n            // key-value pair\r\n            var tmp = line.match(reSplit);\r\n            if (tmp && tmp.length == 3) {\r\n              dictionary[tmp[1]] = evalString(tmp[2]);\r\n            }\r\n          }\r\n        }\r\n        nextEntry();\r\n      }\r\n\r\n      // import another *.properties file\r\n      function loadImport(url, callback) {\r\n        xhrLoadText(url, function(content) {\r\n          parseRawLines(content, false, callback); // don't allow recursive imports\r\n        }, null);\r\n      }\r\n\r\n      // fill the dictionary\r\n      parseRawLines(text, true, function() {\r\n        parsedPropertiesCallback(dictionary);\r\n      });\r\n    }\r\n\r\n    // load and parse l10n data (warning: global variables are used here)\r\n    xhrLoadText(href, function(response) {\r\n      gTextData += response; // mostly for debug\r\n\r\n      // parse *.properties text data into an l10n dictionary\r\n      parseProperties(response, function(data) {\r\n\r\n        // find attribute descriptions, if any\r\n        for (var key in data) {\r\n          var id, prop, index = key.lastIndexOf('.');\r\n          if (index > 0) { // an attribute has been specified\r\n            id = key.substring(0, index);\r\n            prop = key.substr(index + 1);\r\n          } else { // no attribute: assuming text content by default\r\n            id = key;\r\n            prop = gTextProp;\r\n          }\r\n          if (!gL10nData[id]) {\r\n            gL10nData[id] = {};\r\n          }\r\n          gL10nData[id][prop] = data[key];\r\n        }\r\n\r\n        // trigger callback\r\n        if (successCallback) {\r\n          successCallback();\r\n        }\r\n      });\r\n    }, failureCallback);\r\n  }\r\n\r\n  // load and parse all resources for the specified locale\r\n  function loadLocale(lang, callback) {\r\n    // RFC 4646, section 2.1 states that language tags have to be treated as\r\n    // case-insensitive. Convert to lowercase for case-insensitive comparisons.\r\n    if (lang) {\r\n      lang = lang.toLowerCase();\r\n    }\r\n\r\n    callback = callback || function _callback() {};\r\n\r\n    clear();\r\n    gLanguage = lang;\r\n\r\n    // check all <link type=\"application/l10n\" href=\"...\" /> nodes\r\n    // and load the resource files\r\n    var langLinks = getL10nResourceLinks();\r\n    var langCount = langLinks.length;\r\n    if (langCount === 0) {\r\n      // we might have a pre-compiled dictionary instead\r\n      var dict = getL10nDictionary();\r\n      if (dict && dict.locales && dict.default_locale) {\r\n        console.log('using the embedded JSON directory, early way out');\r\n        gL10nData = dict.locales[lang];\r\n        if (!gL10nData) {\r\n          var defaultLocale = dict.default_locale.toLowerCase();\r\n          for (var anyCaseLang in dict.locales) {\r\n            anyCaseLang = anyCaseLang.toLowerCase();\r\n            if (anyCaseLang === lang) {\r\n              gL10nData = dict.locales[lang];\r\n              break;\r\n            } else if (anyCaseLang === defaultLocale) {\r\n              gL10nData = dict.locales[defaultLocale];\r\n            }\r\n          }\r\n        }\r\n        callback();\r\n      } else {\r\n        console.log('no resource to load, early way out');\r\n      }\r\n      // early way out\r\n      fireL10nReadyEvent(lang);\r\n      gReadyState = 'complete';\r\n      return;\r\n    }\r\n\r\n    // start the callback when all resources are loaded\r\n    var onResourceLoaded = null;\r\n    var gResourceCount = 0;\r\n    onResourceLoaded = function() {\r\n      gResourceCount++;\r\n      if (gResourceCount >= langCount) {\r\n        callback();\r\n        fireL10nReadyEvent(lang);\r\n        gReadyState = 'complete';\r\n      }\r\n    };\r\n\r\n    // load all resource files\r\n    function L10nResourceLink(link) {\r\n      var href = link.href;\r\n      // Note: If |gAsyncResourceLoading| is false, then the following callbacks\r\n      // are synchronously called.\r\n      this.load = function(lang, callback) {\r\n        parseResource(href, lang, callback, function() {\r\n          console.warn(href + ' not found.');\r\n          // lang not found, used default resource instead\r\n          console.warn('\"' + lang + '\" resource not found');\r\n          gLanguage = '';\r\n          // Resource not loaded, but we still need to call the callback.\r\n          callback();\r\n        });\r\n      };\r\n    }\r\n\r\n    for (var i = 0; i < langCount; i++) {\r\n      var resource = new L10nResourceLink(langLinks[i]);\r\n      resource.load(lang, onResourceLoaded);\r\n    }\r\n  }\r\n\r\n  // clear all l10n data\r\n  function clear() {\r\n    gL10nData = {};\r\n    gTextData = '';\r\n    gLanguage = '';\r\n    // TODO: clear all non predefined macros.\r\n    // There's no such macro /yet/ but we're planning to have some...\r\n  }\r\n\r\n\r\n  /**\r\n   * Get rules for plural forms (shared with JetPack), see:\r\n   * http://unicode.org/repos/cldr-tmp/trunk/diff/supplemental/language_plural_rules.html\r\n   * https://github.com/mozilla/addon-sdk/blob/master/python-lib/plural-rules-generator.p\r\n   *\r\n   * @param {string} lang\r\n   *    locale (language) used.\r\n   *\r\n   * @return {Function}\r\n   *    returns a function that gives the plural form name for a given integer:\r\n   *       var fun = getPluralRules('en');\r\n   *       fun(1)    -> 'one'\r\n   *       fun(0)    -> 'other'\r\n   *       fun(1000) -> 'other'.\r\n   */\r\n\r\n  function getPluralRules(lang) {\r\n    var locales2rules = {\r\n      'af': 3,\r\n      'ak': 4,\r\n      'am': 4,\r\n      'ar': 1,\r\n      'asa': 3,\r\n      'az': 0,\r\n      'be': 11,\r\n      'bem': 3,\r\n      'bez': 3,\r\n      'bg': 3,\r\n      'bh': 4,\r\n      'bm': 0,\r\n      'bn': 3,\r\n      'bo': 0,\r\n      'br': 20,\r\n      'brx': 3,\r\n      'bs': 11,\r\n      'ca': 3,\r\n      'cgg': 3,\r\n      'chr': 3,\r\n      'cs': 12,\r\n      'cy': 17,\r\n      'da': 3,\r\n      'de': 3,\r\n      'dv': 3,\r\n      'dz': 0,\r\n      'ee': 3,\r\n      'el': 3,\r\n      'en': 3,\r\n      'eo': 3,\r\n      'es': 3,\r\n      'et': 3,\r\n      'eu': 3,\r\n      'fa': 0,\r\n      'ff': 5,\r\n      'fi': 3,\r\n      'fil': 4,\r\n      'fo': 3,\r\n      'fr': 5,\r\n      'fur': 3,\r\n      'fy': 3,\r\n      'ga': 8,\r\n      'gd': 24,\r\n      'gl': 3,\r\n      'gsw': 3,\r\n      'gu': 3,\r\n      'guw': 4,\r\n      'gv': 23,\r\n      'ha': 3,\r\n      'haw': 3,\r\n      'he': 2,\r\n      'hi': 4,\r\n      'hr': 11,\r\n      'hu': 0,\r\n      'id': 0,\r\n      'ig': 0,\r\n      'ii': 0,\r\n      'is': 3,\r\n      'it': 3,\r\n      'iu': 7,\r\n      'ja': 0,\r\n      'jmc': 3,\r\n      'jv': 0,\r\n      'ka': 0,\r\n      'kab': 5,\r\n      'kaj': 3,\r\n      'kcg': 3,\r\n      'kde': 0,\r\n      'kea': 0,\r\n      'kk': 3,\r\n      'kl': 3,\r\n      'km': 0,\r\n      'kn': 0,\r\n      'ko': 0,\r\n      'ksb': 3,\r\n      'ksh': 21,\r\n      'ku': 3,\r\n      'kw': 7,\r\n      'lag': 18,\r\n      'lb': 3,\r\n      'lg': 3,\r\n      'ln': 4,\r\n      'lo': 0,\r\n      'lt': 10,\r\n      'lv': 6,\r\n      'mas': 3,\r\n      'mg': 4,\r\n      'mk': 16,\r\n      'ml': 3,\r\n      'mn': 3,\r\n      'mo': 9,\r\n      'mr': 3,\r\n      'ms': 0,\r\n      'mt': 15,\r\n      'my': 0,\r\n      'nah': 3,\r\n      'naq': 7,\r\n      'nb': 3,\r\n      'nd': 3,\r\n      'ne': 3,\r\n      'nl': 3,\r\n      'nn': 3,\r\n      'no': 3,\r\n      'nr': 3,\r\n      'nso': 4,\r\n      'ny': 3,\r\n      'nyn': 3,\r\n      'om': 3,\r\n      'or': 3,\r\n      'pa': 3,\r\n      'pap': 3,\r\n      'pl': 13,\r\n      'ps': 3,\r\n      'pt': 3,\r\n      'rm': 3,\r\n      'ro': 9,\r\n      'rof': 3,\r\n      'ru': 11,\r\n      'rwk': 3,\r\n      'sah': 0,\r\n      'saq': 3,\r\n      'se': 7,\r\n      'seh': 3,\r\n      'ses': 0,\r\n      'sg': 0,\r\n      'sh': 11,\r\n      'shi': 19,\r\n      'sk': 12,\r\n      'sl': 14,\r\n      'sma': 7,\r\n      'smi': 7,\r\n      'smj': 7,\r\n      'smn': 7,\r\n      'sms': 7,\r\n      'sn': 3,\r\n      'so': 3,\r\n      'sq': 3,\r\n      'sr': 11,\r\n      'ss': 3,\r\n      'ssy': 3,\r\n      'st': 3,\r\n      'sv': 3,\r\n      'sw': 3,\r\n      'syr': 3,\r\n      'ta': 3,\r\n      'te': 3,\r\n      'teo': 3,\r\n      'th': 0,\r\n      'ti': 4,\r\n      'tig': 3,\r\n      'tk': 3,\r\n      'tl': 4,\r\n      'tn': 3,\r\n      'to': 0,\r\n      'tr': 0,\r\n      'ts': 3,\r\n      'tzm': 22,\r\n      'uk': 11,\r\n      'ur': 3,\r\n      've': 3,\r\n      'vi': 0,\r\n      'vun': 3,\r\n      'wa': 4,\r\n      'wae': 3,\r\n      'wo': 0,\r\n      'xh': 3,\r\n      'xog': 3,\r\n      'yo': 0,\r\n      'zh': 0,\r\n      'zu': 3\r\n    };\r\n\r\n    // utility functions for plural rules methods\r\n    function isIn(n, list) {\r\n      return list.indexOf(n) !== -1;\r\n    }\r\n    function isBetween(n, start, end) {\r\n      return start <= n && n <= end;\r\n    }\r\n\r\n    // list of all plural rules methods:\r\n    // map an integer to the plural form name to use\r\n    var pluralRules = {\r\n      '0': function(n) {\r\n        return 'other';\r\n      },\r\n      '1': function(n) {\r\n        if ((isBetween((n % 100), 3, 10)))\r\n          return 'few';\r\n        if (n === 0)\r\n          return 'zero';\r\n        if ((isBetween((n % 100), 11, 99)))\r\n          return 'many';\r\n        if (n == 2)\r\n          return 'two';\r\n        if (n == 1)\r\n          return 'one';\r\n        return 'other';\r\n      },\r\n      '2': function(n) {\r\n        if (n !== 0 && (n % 10) === 0)\r\n          return 'many';\r\n        if (n == 2)\r\n          return 'two';\r\n        if (n == 1)\r\n          return 'one';\r\n        return 'other';\r\n      },\r\n      '3': function(n) {\r\n        if (n == 1)\r\n          return 'one';\r\n        return 'other';\r\n      },\r\n      '4': function(n) {\r\n        if ((isBetween(n, 0, 1)))\r\n          return 'one';\r\n        return 'other';\r\n      },\r\n      '5': function(n) {\r\n        if ((isBetween(n, 0, 2)) && n != 2)\r\n          return 'one';\r\n        return 'other';\r\n      },\r\n      '6': function(n) {\r\n        if (n === 0)\r\n          return 'zero';\r\n        if ((n % 10) == 1 && (n % 100) != 11)\r\n          return 'one';\r\n        return 'other';\r\n      },\r\n      '7': function(n) {\r\n        if (n == 2)\r\n          return 'two';\r\n        if (n == 1)\r\n          return 'one';\r\n        return 'other';\r\n      },\r\n      '8': function(n) {\r\n        if ((isBetween(n, 3, 6)))\r\n          return 'few';\r\n        if ((isBetween(n, 7, 10)))\r\n          return 'many';\r\n        if (n == 2)\r\n          return 'two';\r\n        if (n == 1)\r\n          return 'one';\r\n        return 'other';\r\n      },\r\n      '9': function(n) {\r\n        if (n === 0 || n != 1 && (isBetween((n % 100), 1, 19)))\r\n          return 'few';\r\n        if (n == 1)\r\n          return 'one';\r\n        return 'other';\r\n      },\r\n      '10': function(n) {\r\n        if ((isBetween((n % 10), 2, 9)) && !(isBetween((n % 100), 11, 19)))\r\n          return 'few';\r\n        if ((n % 10) == 1 && !(isBetween((n % 100), 11, 19)))\r\n          return 'one';\r\n        return 'other';\r\n      },\r\n      '11': function(n) {\r\n        if ((isBetween((n % 10), 2, 4)) && !(isBetween((n % 100), 12, 14)))\r\n          return 'few';\r\n        if ((n % 10) === 0 ||\r\n            (isBetween((n % 10), 5, 9)) ||\r\n            (isBetween((n % 100), 11, 14)))\r\n          return 'many';\r\n        if ((n % 10) == 1 && (n % 100) != 11)\r\n          return 'one';\r\n        return 'other';\r\n      },\r\n      '12': function(n) {\r\n        if ((isBetween(n, 2, 4)))\r\n          return 'few';\r\n        if (n == 1)\r\n          return 'one';\r\n        return 'other';\r\n      },\r\n      '13': function(n) {\r\n        if ((isBetween((n % 10), 2, 4)) && !(isBetween((n % 100), 12, 14)))\r\n          return 'few';\r\n        if (n != 1 && (isBetween((n % 10), 0, 1)) ||\r\n            (isBetween((n % 10), 5, 9)) ||\r\n            (isBetween((n % 100), 12, 14)))\r\n          return 'many';\r\n        if (n == 1)\r\n          return 'one';\r\n        return 'other';\r\n      },\r\n      '14': function(n) {\r\n        if ((isBetween((n % 100), 3, 4)))\r\n          return 'few';\r\n        if ((n % 100) == 2)\r\n          return 'two';\r\n        if ((n % 100) == 1)\r\n          return 'one';\r\n        return 'other';\r\n      },\r\n      '15': function(n) {\r\n        if (n === 0 || (isBetween((n % 100), 2, 10)))\r\n          return 'few';\r\n        if ((isBetween((n % 100), 11, 19)))\r\n          return 'many';\r\n        if (n == 1)\r\n          return 'one';\r\n        return 'other';\r\n      },\r\n      '16': function(n) {\r\n        if ((n % 10) == 1 && n != 11)\r\n          return 'one';\r\n        return 'other';\r\n      },\r\n      '17': function(n) {\r\n        if (n == 3)\r\n          return 'few';\r\n        if (n === 0)\r\n          return 'zero';\r\n        if (n == 6)\r\n          return 'many';\r\n        if (n == 2)\r\n          return 'two';\r\n        if (n == 1)\r\n          return 'one';\r\n        return 'other';\r\n      },\r\n      '18': function(n) {\r\n        if (n === 0)\r\n          return 'zero';\r\n        if ((isBetween(n, 0, 2)) && n !== 0 && n != 2)\r\n          return 'one';\r\n        return 'other';\r\n      },\r\n      '19': function(n) {\r\n        if ((isBetween(n, 2, 10)))\r\n          return 'few';\r\n        if ((isBetween(n, 0, 1)))\r\n          return 'one';\r\n        return 'other';\r\n      },\r\n      '20': function(n) {\r\n        if ((isBetween((n % 10), 3, 4) || ((n % 10) == 9)) && !(\r\n            isBetween((n % 100), 10, 19) ||\r\n            isBetween((n % 100), 70, 79) ||\r\n            isBetween((n % 100), 90, 99)\r\n            ))\r\n          return 'few';\r\n        if ((n % 1000000) === 0 && n !== 0)\r\n          return 'many';\r\n        if ((n % 10) == 2 && !isIn((n % 100), [12, 72, 92]))\r\n          return 'two';\r\n        if ((n % 10) == 1 && !isIn((n % 100), [11, 71, 91]))\r\n          return 'one';\r\n        return 'other';\r\n      },\r\n      '21': function(n) {\r\n        if (n === 0)\r\n          return 'zero';\r\n        if (n == 1)\r\n          return 'one';\r\n        return 'other';\r\n      },\r\n      '22': function(n) {\r\n        if ((isBetween(n, 0, 1)) || (isBetween(n, 11, 99)))\r\n          return 'one';\r\n        return 'other';\r\n      },\r\n      '23': function(n) {\r\n        if ((isBetween((n % 10), 1, 2)) || (n % 20) === 0)\r\n          return 'one';\r\n        return 'other';\r\n      },\r\n      '24': function(n) {\r\n        if ((isBetween(n, 3, 10) || isBetween(n, 13, 19)))\r\n          return 'few';\r\n        if (isIn(n, [2, 12]))\r\n          return 'two';\r\n        if (isIn(n, [1, 11]))\r\n          return 'one';\r\n        return 'other';\r\n      }\r\n    };\r\n\r\n    // return a function that gives the plural form name for a given integer\r\n    var index = locales2rules[lang.replace(/-.*$/, '')];\r\n    if (!(index in pluralRules)) {\r\n      console.warn('plural form unknown for [' + lang + ']');\r\n      return function() { return 'other'; };\r\n    }\r\n    return pluralRules[index];\r\n  }\r\n\r\n  // pre-defined 'plural' macro\r\n  gMacros.plural = function(str, param, key, prop) {\r\n    var n = parseFloat(param);\r\n    if (isNaN(n))\r\n      return str;\r\n\r\n    // TODO: support other properties (l20n still doesn't...)\r\n    if (prop != gTextProp)\r\n      return str;\r\n\r\n    // initialize _pluralRules\r\n    if (!gMacros._pluralRules) {\r\n      gMacros._pluralRules = getPluralRules(gLanguage);\r\n    }\r\n    var index = '[' + gMacros._pluralRules(n) + ']';\r\n\r\n    // try to find a [zero|one|two] key if it's defined\r\n    if (n === 0 && (key + '[zero]') in gL10nData) {\r\n      str = gL10nData[key + '[zero]'][prop];\r\n    } else if (n == 1 && (key + '[one]') in gL10nData) {\r\n      str = gL10nData[key + '[one]'][prop];\r\n    } else if (n == 2 && (key + '[two]') in gL10nData) {\r\n      str = gL10nData[key + '[two]'][prop];\r\n    } else if ((key + index) in gL10nData) {\r\n      str = gL10nData[key + index][prop];\r\n    } else if ((key + '[other]') in gL10nData) {\r\n      str = gL10nData[key + '[other]'][prop];\r\n    }\r\n\r\n    return str;\r\n  };\r\n\r\n\r\n  /**\r\n   * l10n dictionary functions\r\n   */\r\n\r\n  // fetch an l10n object, warn if not found, apply `args' if possible\r\n  function getL10nData(key, args, fallback) {\r\n    var data = gL10nData[key];\r\n    if (!data) {\r\n      console.warn('#' + key + ' is undefined.');\r\n      if (!fallback) {\r\n        return null;\r\n      }\r\n      data = fallback;\r\n    }\r\n\r\n    /** This is where l10n expressions should be processed.\r\n      * The plan is to support C-style expressions from the l20n project;\r\n      * until then, only two kinds of simple expressions are supported:\r\n      *   {[ index ]} and {{ arguments }}.\r\n      */\r\n    var rv = {};\r\n    for (var prop in data) {\r\n      var str = data[prop];\r\n      str = substIndexes(str, args, key, prop);\r\n      str = substArguments(str, args, key);\r\n      rv[prop] = str;\r\n    }\r\n    return rv;\r\n  }\r\n\r\n  // replace {[macros]} with their values\r\n  function substIndexes(str, args, key, prop) {\r\n    var reIndex = /\\{\\[\\s*([a-zA-Z]+)\\(([a-zA-Z]+)\\)\\s*\\]\\}/;\r\n    var reMatch = reIndex.exec(str);\r\n    if (!reMatch || !reMatch.length)\r\n      return str;\r\n\r\n    // an index/macro has been found\r\n    // Note: at the moment, only one parameter is supported\r\n    var macroName = reMatch[1];\r\n    var paramName = reMatch[2];\r\n    var param;\r\n    if (args && paramName in args) {\r\n      param = args[paramName];\r\n    } else if (paramName in gL10nData) {\r\n      param = gL10nData[paramName];\r\n    }\r\n\r\n    // there's no macro parser yet: it has to be defined in gMacros\r\n    if (macroName in gMacros) {\r\n      var macro = gMacros[macroName];\r\n      str = macro(str, param, key, prop);\r\n    }\r\n    return str;\r\n  }\r\n\r\n  // replace {{arguments}} with their values\r\n  function substArguments(str, args, key) {\r\n    var reArgs = /\\{\\{\\s*(.+?)\\s*\\}\\}/g;\r\n    return str.replace(reArgs, function(matched_text, arg) {\r\n      if (args && arg in args) {\r\n        return args[arg];\r\n      }\r\n      if (arg in gL10nData) {\r\n        return gL10nData[arg];\r\n      }\r\n      console.log('argument {{' + arg + '}} for #' + key + ' is undefined.');\r\n      return matched_text;\r\n    });\r\n  }\r\n\r\n  // translate an HTML element\r\n  function translateElement(element) {\r\n    var l10n = getL10nAttributes(element);\r\n    if (!l10n.id)\r\n      return;\r\n\r\n    // get the related l10n object\r\n    var data = getL10nData(l10n.id, l10n.args);\r\n    if (!data) {\r\n      console.warn('#' + l10n.id + ' is undefined.');\r\n      return;\r\n    }\r\n\r\n    // translate element (TODO: security checks?)\r\n    if (data[gTextProp]) { // XXX\r\n      if (getChildElementCount(element) === 0) {\r\n        element[gTextProp] = data[gTextProp];\r\n      } else {\r\n        // this element has element children: replace the content of the first\r\n        // (non-empty) child textNode and clear other child textNodes\r\n        var children = element.childNodes;\r\n        var found = false;\r\n        for (var i = 0, l = children.length; i < l; i++) {\r\n          if (children[i].nodeType === 3 && /\\S/.test(children[i].nodeValue)) {\r\n            if (found) {\r\n              children[i].nodeValue = '';\r\n            } else {\r\n              children[i].nodeValue = data[gTextProp];\r\n              found = true;\r\n            }\r\n          }\r\n        }\r\n        // if no (non-empty) textNode is found, insert a textNode before the\r\n        // first element child.\r\n        if (!found) {\r\n          var textNode = document.createTextNode(data[gTextProp]);\r\n          element.insertBefore(textNode, element.firstChild);\r\n        }\r\n      }\r\n      delete data[gTextProp];\r\n    }\r\n\r\n    for (var k in data) {\r\n      element[k] = data[k];\r\n    }\r\n  }\r\n\r\n  // webkit browsers don't currently support 'children' on SVG elements...\r\n  function getChildElementCount(element) {\r\n    if (element.children) {\r\n      return element.children.length;\r\n    }\r\n    if (typeof element.childElementCount !== 'undefined') {\r\n      return element.childElementCount;\r\n    }\r\n    var count = 0;\r\n    for (var i = 0; i < element.childNodes.length; i++) {\r\n      count += element.nodeType === 1 ? 1 : 0;\r\n    }\r\n    return count;\r\n  }\r\n\r\n  // translate an HTML subtree\r\n  function translateFragment(element) {\r\n    element = element || document.documentElement;\r\n\r\n    // check all translatable children (= w/ a `data-l10n-id' attribute)\r\n    var children = getTranslatableChildren(element);\r\n    var elementCount = children.length;\r\n    for (var i = 0; i < elementCount; i++) {\r\n      translateElement(children[i]);\r\n    }\r\n\r\n    // translate element itself if necessary\r\n    translateElement(element);\r\n  }\r\n\r\n  return {\r\n    // get a localized string\r\n    get: function(key, args, fallbackString) {\r\n      var index = key.lastIndexOf('.');\r\n      var prop = gTextProp;\r\n      if (index > 0) { // An attribute has been specified\r\n        prop = key.substr(index + 1);\r\n        key = key.substring(0, index);\r\n      }\r\n      var fallback;\r\n      if (fallbackString) {\r\n        fallback = {};\r\n        fallback[prop] = fallbackString;\r\n      }\r\n      var data = getL10nData(key, args, fallback);\r\n      if (data && prop in data) {\r\n        return data[prop];\r\n      }\r\n      return '{{' + key + '}}';\r\n    },\r\n\r\n    // debug\r\n    getData: function() { return gL10nData; },\r\n    getText: function() { return gTextData; },\r\n\r\n    // get|set the document language\r\n    getLanguage: function() { return gLanguage; },\r\n    setLanguage: function(lang, callback) {\r\n      loadLocale(lang, function() {\r\n        if (callback)\r\n          callback();\r\n        translateFragment();\r\n      });\r\n    },\r\n\r\n    // get the direction (ltr|rtl) of the current language\r\n    getDirection: function() {\r\n      // http://www.w3.org/International/questions/qa-scripts\r\n      // Arabic, Hebrew, Farsi, Pashto, Urdu\r\n      var rtlList = ['ar', 'he', 'fa', 'ps', 'ur'];\r\n      var shortCode = gLanguage.split('-', 1)[0];\r\n      return (rtlList.indexOf(shortCode) >= 0) ? 'rtl' : 'ltr';\r\n    },\r\n\r\n    // translate an element or document fragment\r\n    translate: translateFragment,\r\n\r\n    // this can be used to prevent race conditions\r\n    getReadyState: function() { return gReadyState; },\r\n    ready: function(callback) {\r\n      if (!callback) {\r\n        return;\r\n      } else if (gReadyState == 'complete' || gReadyState == 'interactive') {\r\n        window.setTimeout(function() {\r\n          callback();\r\n        });\r\n      } else if (document.addEventListener) {\r\n        document.addEventListener('localized', function once() {\r\n          document.removeEventListener('localized', once);\r\n          callback();\r\n        });\r\n      }\r\n    }\r\n  };\r\n}) (window, document);\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/l10n.js\n// module id = 94\n// module chunks = 4"],"sourceRoot":""}